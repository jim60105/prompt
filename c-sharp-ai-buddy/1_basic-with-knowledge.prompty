---
name: C# AI Buddy
description: |
  ğŸ¤– ä½ çš„ C# å¤¥ä¼´ â€” C# AI Buddy ç¾å·²ä¸Šç·šï¼
  ğŸ’» æˆ‘éš¨æ™‚æº–å‚™è§£ç­”ä½ å° C# çš„å•é¡Œï¼Œæä¾›ç¨‹å¼ç¢¼æœ€ä½³åŒ–å»ºè­°ï¼ŒåŠ©ä½ å¿«é€ŸæŒæ¡é€™é–€å¼·å¤§çš„ç¨‹å¼èªè¨€ã€‚
  ğŸš€ ç„¡è«–ä½ æ˜¯åˆå­¸è€…é‚„æ˜¯è³‡æ·±é–‹ç™¼è€…ï¼ŒC# AI Buddy éƒ½å°‡æˆç‚ºä½ é–‹ç™¼æ—…ç¨‹ä¸­ä¸å¯æˆ–ç¼ºçš„å¾—åŠ›åŠ©æ‰‹ï¼
model:
  configuration:
    name: claude-3-5-sonnet-latest
sample:
  BOT_USER_INPUT: |
    æ•™æˆ‘ DI ä¾é ¼æ³¨å…¥
  knowledge: |
    [
    {
        "output": "URL: https://learn.microsoft.com/zh-tw/aspnet/core/fundamentals/\nTITLE: ASP.NET Core åŸºæœ¬æ¦‚å¿µçš„æ¦‚è§€\nCONTENT: \n\t\n\t\tè·³åˆ°ä¸»è¦å…§å®¹\n\n\t\t\n\t\t\t\tå·²ä¸å†æ”¯æ´æ­¤ç€è¦½å™¨ã€‚\n\t\t\t\tè«‹å‡ç´šè‡³ Microsoft Edgeï¼Œä»¥åˆ©ç”¨æœ€æ–°åŠŸèƒ½ã€å®‰å…¨æ€§æ›´æ–°å’ŒæŠ€è¡“æ”¯æ´ã€‚\n\t\t\t\t\n\t\t\t\n\t\t\n\n\t\t\n\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\n\t\n\n\t\n\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\tASP.NET Core åŸºæœ¬æ¦‚å¿µçš„æ¦‚è§€\n\t\t\t\t\t\t\t\t\t\t\tç™¼è¡Œé …11/14/2024\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tæœ¬æ–‡å…§å®¹\n\t\t\t\t\t\t\t\t\t\t\næ³¨æ„\né€™ä¸æ˜¯é€™ç¯‡æ–‡ç« çš„æœ€æ–°ç‰ˆæœ¬ã€‚ å¦‚éœ€ç›®å‰çš„ç‰ˆæœ¬ï¼Œè«‹åƒé–± æœ¬æ–‡çš„ .NET 9 ç‰ˆæœ¬ã€‚\n\n\n\né‡è¦\né€™äº›ç™¼è¡Œå‰ç”¢å“çš„ç›¸é—œè³‡è¨Šåœ¨ç”¢å“æ­£å¼ç™¼è¡Œå‰å¯èƒ½æœƒæœ‰å¤§å¹…ä¿®æ”¹ã€‚ Microsoft å°æ­¤è™•æä¾›çš„è³‡è¨Šï¼Œä¸åšä»»ä½•æ˜ç¢ºæˆ–éš±å«çš„ç‘•ç–µæ“”ä¿ã€‚\nå¦‚éœ€ç›®å‰çš„ç‰ˆæœ¬ï¼Œè«‹åƒé–± æœ¬æ–‡çš„ .NET 9 ç‰ˆæœ¬ã€‚\n\n\n\næœ¬æ–‡æä¾›å»ºç½® ASP.NET Core æ‡‰ç”¨ç¨‹å¼çš„åŸºæœ¬æ¦‚å¿µæ¦‚è§€ï¼ŒåŒ…æ‹¬ç›¸ä¾æ€§æ’å…¥ (DI)ã€è¨­å®šã€ä¸­ä»‹è»Ÿé«”ç­‰ç­‰ã€‚\nå¦‚éœ€ Blazor åŸºæœ¬æ¦‚å¿µæŒ‡å¼•ï¼Œé€™æœƒæ–°å¢æˆ–å–ä»£æœ¬æ–‡ä¸­çš„æŒ‡å°æ–¹é‡ï¼Œè«‹åƒé–± ASP.NET Core Blazor åŸºæœ¬æ¦‚å¿µã€‚\nProgram.cs\nä½¿ç”¨ Web ç¯„æœ¬å»ºç«‹çš„ ASP.NET Core æ‡‰ç”¨ç¨‹å¼åŒ…å« Program.cs æª”æ¡ˆä¸­çš„æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•ç¨‹å¼ç¢¼ã€‚ \n              Program.cs æª”æ¡ˆä½æ–¼ä¸‹åˆ—ä½ç½®ï¼š\n\nå·²è¨­å®šæ‡‰ç”¨ç¨‹å¼æ‰€éœ€çš„æœå‹™ã€‚\næ‡‰ç”¨ç¨‹å¼çš„è¦æ±‚è™•ç†ç®¡ç·šæ˜¯å®šç¾©ç‚ºä¸€ç³»åˆ—ä¸­ä»‹è»Ÿé«”å…ƒä»¶ã€‚\n\nä¸‹åˆ—æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•ç¨‹å¼ä»£ç¢¼æ”¯æ´æ•¸ç¨®æ‡‰ç”¨ç¨‹å¼é¡å‹ï¼š\n\n\n              \n              Blazor Web Apps\n\n              \n              Razor Pages\n\n              MVC æ§åˆ¶å™¨èˆ‡æª¢è¦–\n\n              Web API èˆ‡æ§åˆ¶å™¨\n\n              æœ€å° web API\n\nusing WebAll.Components;\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorComponents()\n    .AddInteractiveServerComponents();\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\n\napp.UseAuthorization();\n\napp.MapGet(\"/hi\", () => \"Hello!\");\n\napp.MapDefaultControllerRoute();\napp.MapRazorPages();\n\napp.MapRazorComponents<App>()\n    .AddInteractiveServerRenderMode();\n\napp.UseAntiforgery();\n\napp.Run();\nç›¸ä¾æ€§æ’å…¥ (æœå‹™)\nASP.NET Core åŠŸèƒ½å…§å»ºçš„ ç›¸ä¾æ³¨å…¥ ï¼ˆDIï¼‰ï¼Œè®“è¨­å®šå¥½çš„æœå‹™èƒ½åœ¨æ•´å€‹æ‡‰ç”¨ç¨‹å¼ä¸­ä½¿ç”¨ã€‚ åœ¨ä¸Šè¿°ç¨‹å¼ç¢¼ä¸­ï¼Œæœå‹™æœƒæ–°å¢è‡³å…·æœ‰ WebApplicationBuilder.Servicesã€builder.Services çš„ DI å®¹å™¨ã€‚ å…·ç¾åŒ– WebApplicationBuilder æ™‚ï¼Œæœƒè‡ªå‹•æ–°å¢è¨±å¤š æ¶æ§‹æä¾›çš„æœå‹™é …ç›®ã€‚ \n              builder æ˜¯ä¸‹åˆ—ç¨‹å¼ç¢¼ä¸­çš„ WebApplicationBuilderï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\nåœ¨ä¸Šè¿°ç¨‹å¼ä»£ç¢¼ä¸­ï¼ŒCreateBuilder å°‡è¨­å®šã€è¨˜éŒ„å’Œ è¨±å¤šå…¶ä»–æœå‹™ è‡³ DI å®¹å™¨ã€‚ DI æ¶æ§‹æœƒåœ¨é‹è¡Œæ™‚é–“æä¾›è¦æ±‚æœå‹™çš„å¯¦ä¾‹ã€‚\nä¸‹åˆ—ç¨‹å¼ä»£ç¢¼æœƒå°‡è‡ªè¨‚ DbContext å’Œ Blazor å…ƒä»¶æ–°å¢è‡³ DI å®¹å™¨ï¼š\nvar builder = WebApplication.CreateBuilder(args);\nbuilder.Services.AddDbContextFactory<BlazorWebAppMoviesContext>(options =>\n    options.UseSqlServer(builder.Configuration.GetConnectionString(\"MoviesContext\") \n        ?? throw new InvalidOperationException(\"Connection string not found.\")));\n\nbuilder.Services.AddQuickGridEntityFrameworkAdapter();\n\nbuilder.Services.AddDatabaseDeveloperPageExceptionFilter();\n\n// Add services to the container.\nbuilder.Services.AddRazorComponents()\n    .AddInteractiveServerComponents();\n\nvar app = builder.Build();\n\nåœ¨ Blazor Web Appä¸­ï¼Œæœå‹™é€šå¸¸æœƒåœ¨åŸ·è¡Œæ™‚å¾ DI è§£æï¼Œæ–¹æ³•æ˜¯åœ¨ Razor å…ƒä»¶ä¸­ä½¿ç”¨ @inject æŒ‡ä»¤ï¼Œå¦‚ä¸‹åˆ—ç¯„ä¾‹æ‰€ç¤ºï¼š\n@page \"/movies\"\n@rendermode InteractiveServer\n@using Microsoft.EntityFrameworkCore\n@using Microsoft.AspNetCore.Components.QuickGrid\n@using BlazorWebAppMovies.Models\n@using BlazorWebAppMovies.Data\n@implements IAsyncDisposable\n@inject IDbContextFactory<BlazorWebAppMovies.Data.BlazorWebAppMoviesContext> DbFactory\n\n<PageTitle>Index</PageTitle>\n\n<h1>Index</h1>\n\n<div>\n    <input type=\"search\" @bind=\"titleFilter\" @bind:event=\"oninput\" />\n</div>\n\n<p>\n    <a href=\"movies/create\">Create New</a>\n</p>\n\n<QuickGrid Class=\"table\" Items=\"FilteredMovies\" Pagination=\"pagination\">\n    <PropertyColumn Property=\"movie => movie.Title\" Sortable=\"true\" />\n    <PropertyColumn Property=\"movie => movie.ReleaseDate\" Title=\"Release Date\" />\n    <PropertyColumn Property=\"movie => movie.Genre\" />\n    <PropertyColumn Property=\"movie => movie.Price\" />\n    <PropertyColumn Property=\"movie => movie.Rating\" />\n\n    <TemplateColumn Context=\"movie\">\n        <a href=\"@($\"movies/edit?id={movie.Id}\")\">Edit</a> |\n        <a href=\"@($\"movies/details?id={movie.Id}\")\">Details</a> |\n        <a href=\"@($\"movies/delete?id={movie.Id}\")\">Delete</a>\n    </TemplateColumn>\n</QuickGrid>\n\n<Paginator State=\"pagination\" />\n\n@code {\n    private BlazorWebAppMoviesContext context = default!;\n    private PaginationState pagination = new PaginationState { ItemsPerPage = 10 };\n    private string titleFilter = string.Empty;\n\n    private IQueryable<Movie> FilteredMovies =>\n        context.Movie.Where(m => m.Title!.Contains(titleFilter));\n\n    protected override void OnInitialized()\n    {\n        context = DbFactory.CreateDbContext();\n    }\n\n    public async ValueTask DisposeAsync() => await context.DisposeAsync();\n}\n\nåœ¨ä¸Šè¿°ç¨‹å¼ä»£ç¢¼ä¸­ï¼š\n\nä½¿ç”¨ @inject æŒ‡ç¤ºè©ã€‚\næœå‹™æœƒåœ¨ OnInitialized æ–¹æ³•ä¸­è§£æï¼Œä¸¦æŒ‡æ´¾çµ¦ context è®Šæ•¸ã€‚\n\n              context æœå‹™å‰µå»º FilteredMovie æ¸…å–®ã€‚\n\nå¦ä¸€ç¨®å¾ DI è§£ææœå‹™çš„æ–¹æ³•æ˜¯é€éå»ºæ§‹å­æ³¨å…¥ã€‚ ä¸‹åˆ— Razor Pages ç¨‹å¼ä»£ç¢¼æœƒä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥è§£æè³‡æ–™åº«å…§å®¹å’Œ DI çš„è¨˜éŒ„å™¨ï¼š\npublic class IndexModel : PageModel\n{\n    private readonly RazorPagesMovieContext _context;\n    private readonly ILogger<IndexModel> _logger;\n\n    public IndexModel(RazorPagesMovieContext context, ILogger<IndexModel> logger)\n    {\n        _context = context;\n        _logger = logger;\n    }\n\n    public IList<Movie> Movie { get;set; }\n\n    public async Task OnGetAsync()\n    {\n        _logger.LogInformation(\"IndexModel OnGetAsync.\");\n        Movie = await _context.Movie.ToListAsync();\n    }\n}\n\nåœ¨ä¸Šè¿°ç¨‹å¼ä»£ç¢¼ä¸­ï¼ŒIndexModel å»ºæ§‹å‡½å¼æœƒæ¡ç”¨é¡å‹ç‚º RazorPagesMovieContextçš„åƒæ•¸ï¼Œå…¶æœƒåœ¨é‹è¡Œæ™‚é–“è§£æç‚º _context è®Šæ•¸ã€‚ å…§å®¹ç‰©ä»¶å¯ç”¨ä¾†åœ¨ OnGetAsync æ–¹æ³•ä¸­å»ºç«‹é›»å½±æ¸…å–®ã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core Blazor ç›¸ä¾æ€§æ³¨å…¥ å’Œ ASP.NET Coreä¸­çš„ç›¸ä¾æ€§æ³¨å…¥ã€‚\nä¸­ä»‹è»Ÿé«”\nè¦æ±‚è™•ç†ç®¡ç·šç”±ä¸€ç³»åˆ—ä¸­ä»‹è»Ÿé«”å…ƒä»¶æ‰€çµ„æˆã€‚ æ¯å€‹å…ƒä»¶æœƒåœ¨ HttpContext ä¸ŠåŸ·è¡Œæ“ä½œï¼Œä¸¦å«ç”¨ç®¡ç·šä¸­ä¸‹ä¸€å€‹ä¸­ä»‹è»Ÿé«”æˆ–çµ‚æ­¢è¦æ±‚ã€‚\nä¾ç…§æ…£ä¾‹ï¼Œä¸­ä»‹è»Ÿé«”å…ƒä»¶æœƒé€éå«ç”¨ Use{Feature} å»¶ä¼¸æ¨¡çµ„æ–¹æ³•ä¾†æ–°å¢è‡³ç®¡ç·šã€‚ ä¸‹åˆ—ç¨‹å¼ä»£ç¢¼èªªæ˜å¦‚ä½•ä½¿ç”¨åç‚º Use{Feature} çš„æ–¹æ³•ï¼Œå°‡ä¸­é–“ä»¶æ–°å¢è‡³æ‡‰ç”¨ç¨‹å¼ï¼š\nvar builder = WebApplication.CreateBuilder(args);\nbuilder.Services.AddDbContextFactory<BlazorWebAppMoviesContext>(options =>\n    options.UseSqlServer(builder.Configuration.GetConnectionString(\"MoviesContext\") \n        ?? throw new InvalidOperationException(\"Connection string not found.\")));\n\nbuilder.Services.AddQuickGridEntityFrameworkAdapter();\n\nbuilder.Services.AddDatabaseDeveloperPageExceptionFilter();\n\n// Add services to the container.\nbuilder.Services.AddRazorComponents()\n    .AddInteractiveServerComponents();\n\nvar app = builder.Build();\n\nusing (var scope = app.Services.CreateScope())\n{\n    var services = scope.ServiceProvider;\n\n    SeedData.Initialize(services);\n}\n\n// Configure the HTTP request pipeline.\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\", createScopeForErrors: true);\n    app.UseHsts();\n    app.UseMigrationsEndPoint();\n}\napp.UseHttpsRedirection();\n\napp.UseAntiforgery();\n\napp.MapStaticAssets();\napp.MapRazorComponents<App>()\n    .AddInteractiveServerRenderMode();\n\napp.Run();\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­ä»‹è»Ÿé«”ã€‚\nHost\nåœ¨å•Ÿå‹•æ™‚ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼æœƒå»ºç½®ä¸€å€‹ã€Œä¸»æ©Ÿã€ã€‚ ä¸»æ©Ÿæœƒå°è£æ‰€æœ‰æ‡‰ç”¨ç¨‹å¼çš„è³‡æºï¼Œä¾‹å¦‚ï¼š\n\nHTTP ä¼ºæœå™¨å¯¦ä½œ\nä¸­ä»‹è»Ÿé«”å…ƒä»¶\nè¨˜éŒ„\nç›¸ä¾æ€§æ’å…¥ (æœå‹™)\nçµ„æ…‹\n\næœ‰ä¸‰å€‹ä¸åŒçš„ä¸»æ©Ÿèƒ½å¤ åŸ·è¡Œ ASP.NET Core æ‡‰ç”¨ç¨‹å¼ï¼š\n\n\n              ASP.NET Core WebApplicationï¼Œä¹Ÿç¨±ç‚ºæœ€å°ä¸»æ©Ÿ\nçµåˆ ASP.NET Core  çš„ ConfigureWebHostDefaults\n\n              ASP.NET Core WebHost\n\nå»ºè­°ä½¿ç”¨ ASP.NET Core WebApplication å’Œ WebApplicationBuilder é¡å‹ï¼Œä¸¦ç”¨æ–¼æ‰€æœ‰ ASP.NET Core ç¯„æœ¬ä¸­ã€‚ \n              WebApplication çš„è¡Œç‚ºé¡ä¼¼æ–¼ .NET æ³›å‹ä¸»æ©Ÿï¼Œä¸¦å…¬é–‹è¨±å¤šç›¸åŒçš„ä»‹é¢ï¼Œä½†éœ€è¦è¼ƒå°‘çš„å›å‘¼æ‰èƒ½è¨­å®šã€‚ ASP.NET Core WebHost åƒ…é©ç”¨æ–¼å›æº¯ç›¸å®¹æ€§ã€‚\nä¸‹åˆ—ç¯„ä¾‹æœƒå…·ç¾åŒ– WebApplicationï¼Œä¸¦å°‡å®ƒæŒ‡æ´¾çµ¦åç‚º appçš„è®Šæ•¸ï¼š\nvar builder = WebApplication.CreateBuilder(args);\nbuilder.Services.AddDbContextFactory<BlazorWebAppMoviesContext>(options =>\n    options.UseSqlServer(builder.Configuration.GetConnectionString(\"MoviesContext\") \n        ?? throw new InvalidOperationException(\"Connection string not found.\")));\n\nbuilder.Services.AddQuickGridEntityFrameworkAdapter();\n\nbuilder.Services.AddDatabaseDeveloperPageExceptionFilter();\n\n// Add services to the container.\nbuilder.Services.AddRazorComponents()\n    .AddInteractiveServerComponents();\n\nvar app = builder.Build();\n\n\n              WebApplicationBuilder.Build æ–¹æ³•æœƒä½¿ç”¨ä¸€çµ„é è¨­é¸é …ä¾†è¨­å®šä¸»æ©Ÿï¼Œä¾‹å¦‚ï¼š\n\nä½¿ç”¨ Kestrel åšç‚ºç¶²é ä¼ºæœå™¨ï¼Œä¸¦å•Ÿç”¨ IIS æ•´åˆã€‚\nå¾ ã€ç’°å¢ƒè®Šæ•¸ã€å‘½ä»¤åˆ—å¼•æ•¸åŠå…¶ä»–ä¾†æºè¼‰å…¥appsettings.jsonã€‚\nå°‡è¨˜éŒ„è¼¸å‡ºå‚³é€åˆ°ä¸»æ§å°åŠåµéŒ¯æä¾›è€…ã€‚\n\né Web æ¡ˆä¾‹\nä¸€èˆ¬ä¸»æ©Ÿå¯è®“å…¶ä»–é¡å‹çš„æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨è·¨é ˜åŸŸæ¶æ§‹å»¶ä¼¸æ¨¡çµ„ï¼Œä¾‹å¦‚è¨˜éŒ„ã€ç›¸ä¾æ€§æ’å…¥ ï¼ˆDIï¼‰ã€çµ„æ…‹å’Œæ‡‰ç”¨ç¨‹å¼å­˜ç•™æœŸç®¡ç†ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„ .NET æ³›å‹ä¸»æ©Ÿï¼Œä»¥åŠåœ¨ ASP.NET Core ä¸­ä½¿ç”¨è¨—ç®¡æœå‹™çš„èƒŒæ™¯å·¥ä½œã€‚\nä¼ºæœå™¨\nASP.NET Core æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨ HTTP ä¼ºæœå™¨å¯¦ä½œä¾†æ¥è½ HTTP è¦æ±‚ã€‚ ä¼ºæœå™¨æœƒæŠŠå‘æ‡‰ç”¨ç¨‹å¼ç™¼å‡ºçš„è¦æ±‚ä½œç‚ºä¸€çµ„è¦æ±‚åŠŸèƒ½ï¼Œåˆä½µæˆä¸€å€‹ HttpContextã€‚\n\n\n\n\n              Windows\n\n\n\n              macOS\n\n\n\n              Linux\n\n\n\n\nASP.NET Core éš¨é™„ä¸‹åˆ—ä¼ºæœå™¨å¯¦ä½œï¼š\n\n\n              Kestrel æ˜¯è·¨å¹³å°çš„ç¶²é ä¼ºæœå™¨ã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ IIS åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚ åœ¨ ASP.NET Core 2.0 å’Œæ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä½œç‚ºç›´æ¥å…¬é–‹è‡³å› ç‰¹ç¶²çš„å…¬é–‹é‚Šç·£ä¼ºæœå™¨ä¾†åŸ·è¡Œã€‚\n\n              IIS HTTP ä¼ºæœå™¨å‰‡æ˜¯é©ç”¨æ–¼ä½¿ç”¨ IIS Windows çš„ä¼ºæœå™¨ã€‚ é€éæ­¤ä¼ºæœå™¨ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼åŠ IIS ä¾¿å¯ä»¥åœ¨ç›¸åŒè™•ç†åºä¸­åŸ·è¡Œã€‚\n\n              HTTP.sys å‰‡æ˜¯é©ç”¨æ–¼ä¸¦æœªæ­é… IIS ä½¿ç”¨ Windows çš„ä¼ºæœå™¨ã€‚\n\n\n\n\nASP.NET Core æä¾› Kestrel è·¨å¹³å°ä¼ºæœå™¨å¯¦ä½œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ Nginx æˆ– Apache åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚\n\n\n\nASP.NET Core æä¾› Kestrel è·¨å¹³å°ä¼ºæœå™¨å¯¦ä½œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ Nginx æˆ– Apache åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚\n\n\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­å¯¦ä½œç¶²é ä¼ºæœå™¨ã€‚\nçµ„æ…‹\nASP.NET Core æä¾›çµ„æ…‹æ¶æ§‹ï¼Œå¯å¾çµ„æ…‹æä¾›è€…çš„å·²æ’åºé›†åˆä¸­ï¼Œä»¥æˆå°åç¨±å’Œæ•¸å€¼çš„å½¢å¼å–å¾—è¨­å®šã€‚ æ‚¨å¯ä»¥ä½¿ç”¨å„ç¨®ä¾†æºçš„å…§å»ºçµ„æ…‹æä¾›è€…ï¼Œä¾‹å¦‚ .json æª”æ¡ˆã€.xml æª”æ¡ˆã€ç’°å¢ƒè®Šæ•¸åŠå‘½ä»¤åˆ—å¼•æ•¸ã€‚ æ’°å¯«è‡ªè¨‚çµ„æ…‹æä¾›è€…ä»¥æ”¯æ´å…¶ä»–ä¾†æºã€‚\næ ¹æ“šé è¨­ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼æœƒè¨­å®šç‚ºå¾ appsettings.jsonã€ç’°å¢ƒè®Šæ•¸ã€å‘½ä»¤åˆ—ç­‰é€²è¡Œè®€å–ã€‚ è¼‰å…¥æ‡‰ç”¨ç¨‹å¼çš„çµ„æ…‹æ™‚ï¼Œä¾†è‡ªç’°å¢ƒè®Šæ•¸çš„å€¼æœƒè¦†å¯«ä¾†è‡ª appsettings.json çš„å€¼ã€‚\nç‚ºäº†åœ¨é–‹ç™¼ç’°å¢ƒä¸­ç®¡ç†æ©Ÿå¯†è¨­å®šæ•¸æ“šï¼Œä¾‹å¦‚å¯†ç¢¼ï¼Œ.NET Core æä¾› Secret Managerã€‚ é‡å°ç”Ÿç”¢ç¥•å¯†ï¼Œæˆ‘å€‘å»ºè­°ä½¿ç”¨ Azure Key Vaultã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„çµ„æ…‹ã€‚\nç’°å¢ƒ\nASP.NET Core ä¸­æä¾›åŸ·è¡Œç’°å¢ƒï¼Œä¾‹å¦‚ Developmentã€Staging å’Œ Productionã€‚ é€éè¨­å®š ASPNETCORE_ENVIRONMENT ç’°å¢ƒè®Šæ•¸ä¾†æŒ‡å®šæ‡‰ç”¨ç¨‹å¼åŸ·è¡Œçš„ç’°å¢ƒã€‚ ASP.NET Core æœƒåœ¨æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•æ™‚è®€å–ç’°å¢ƒè®Šæ•¸ï¼Œç„¶å¾Œå°‡å€¼å„²å­˜åœ¨ IWebHostEnvironment å¯¦ä½œä¸­ã€‚ æ‚¨å¯åœ¨æ‡‰ç”¨ç¨‹å¼ä¸­é€éç›¸ä¾æ€§æ’å…¥ (DI) å–å¾—æ­¤å¯¦ä½œã€‚\nä¸‹åˆ—ç¯„ä¾‹æœƒåœ¨æœªæ–¼  ç’°å¢ƒä¸­åŸ·è¡Œæ™‚ï¼Œè¨­å®šä¾‹å¤–è™•ç†å¸¸å¼å’Œ Development ä¸­ä»‹è»Ÿé«”ï¼š\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\", createScopeForErrors: true);\n    app.UseHsts();\n    app.UseMigrationsEndPoint();\n}\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä½¿ç”¨å¤šå€‹ç’°å¢ƒ (éƒ¨åˆ†æ©Ÿå™¨ç¿»è­¯)ã€‚\nè¨˜éŒ„\nASP.NET Core æ”¯æ´è¨˜éŒ„ APIï¼Œæ­¤ API èƒ½èˆ‡å„ç¨®å…§å»ºå’Œç¬¬ä¸‰æ–¹è¨˜éŒ„æä¾›è€…æ­é…ä½¿ç”¨ã€‚ å¯ç”¨çš„æä¾›è€…åŒ…æ‹¬ï¼š\n\nä¸»æ§å°\nåµéŒ¯\nWindows ä¸Šçš„äº‹ä»¶è¿½è¹¤\nWindows äº‹ä»¶è¨˜éŒ„æª”\nTraceSource\nAzure App Service\nAzure Application Insights\n\nè‹¥è¦å»ºç«‹è¨˜éŒ„ï¼ŒILogger<TCategoryName>è«‹å¾ç›¸ä¾æ€§æ’å…¥ (DI) å’Œé€šè©±è¨˜éŒ„æ–¹æ³• (ä¾‹å¦‚ LogInformation) è§£ææœå‹™ã€‚ ä¸‹åˆ—ç¯„ä¾‹ç¤ºç¯„å¦‚ä½•å–å¾—å’Œä½¿ç”¨ Blazor Web Appä¸­é é¢ .razor æª”æ¡ˆä¸­çš„è¨˜éŒ„å™¨ã€‚ ç•¶åœ¨ Program.csä¸­å‘¼å« CreateBuilder æ–¹æ³•æ™‚ï¼Œè¨˜éŒ„å™¨ç‰©ä»¶åŠå…¶æ§åˆ¶å°æä¾›è€…æœƒè‡ªå‹•å„²å­˜åœ¨ DI å®¹å™¨ä¸­ã€‚\n@page \"/weather\"\n@attribute [StreamRendering]\n@inject ILogger<Weather> Logger\n\n<PageTitle>Weather</PageTitle>\n\n<h1>Weather</h1>\n\n<p>This component demonstrates showing data and logging.</p>\n\n@if (forecasts == null)\n{\n    <p><em>Loading...</em></p>\n}\nelse\n{\n    <table class=\"table\">\n        <thead>\n            <tr>\n                <th>Date</th>\n                <th aria-label=\"Temperature in Celsius\">Temp. (C)</th>\n                <th aria-label=\"Temperature in Fahrenheit\">Temp. (F)</th>\n                <th>Summary</th>\n            </tr>\n        </thead>\n        <tbody>\n            @foreach (var forecast in forecasts)\n            {\n                <tr>\n                    <td>@forecast.Date.ToShortDateString()</td>\n                    <td>@forecast.TemperatureC</td>\n                    <td>@forecast.TemperatureF</td>\n                    <td>@forecast.Summary</td>\n                </tr>\n            }\n        </tbody>\n    </table>\n}\n\n@code {\n    private WeatherForecast[]? forecasts;\n\n    protected override async Task OnInitializedAsync()\n    {\n        // Simulate asynchronous loading to demonstrate streaming rendering\n       \n        await Task.Delay(500);\n\n        Logger.LogInformation(\"This is an information log message.\");\n        Logger.LogWarning(\"This is a warning log message.\");\n        Logger.LogError(\"This is an error log message.\");\n\n        var startDate = DateOnly.FromDateTime(DateTime.Now);\n        var summaries = new[] { \"Freezing\", \"Bracing\", \"Chilly\",\n            \"Cool\", \"Mild\", \"Warm\", \"Balmy\", \"Hot\", \"Sweltering\", \"Scorching\" };\n        forecasts = Enumerable.Range(1, 5).Select(index => new WeatherForecast\n        {\n            Date = startDate.AddDays(index),\n            TemperatureC = Random.Shared.Next(-20, 55),\n            Summary = summaries[Random.Shared.Next(summaries.Length)]\n        }).ToArray();\n    }\n\n    private class WeatherForecast\n    {\n        public DateOnly Date { get; set; }\n        public int TemperatureC { get; set; }\n        public string? Summary { get; set; }\n        public int TemperatureF => 32 + (int)(TemperatureC / 0.5556);\n    }\n}\n\nå¦‚éœ€è©³ç´°è³‡æ–™ï¼Œè«‹åƒé–± .NET Core èˆ‡ ASP.NET Core ä¸­çš„è¨˜éŒ„ã€‚\nè·¯ç”±\nASP.NET Core ä¸­çš„è·¯ç”±æ˜¯å°‡é€£å…¥è¦æ±‚å°æ‡‰è‡³æ‡‰ç”¨ç¨‹å¼ä¸­ç‰¹å®šç«¯é»çš„æ©Ÿåˆ¶ã€‚ å®ƒå¯è®“æ‚¨å®šç¾©å°æ‡‰è‡³ä¸åŒå…ƒä»¶çš„ URL æ¨¡å¼ï¼Œä¾‹å¦‚ Blazor å…ƒä»¶ã€Razor é é¢ã€MVC æ§åˆ¶å™¨å‹•ä½œæˆ–ä¸­é–“ä»¶ã€‚\n\n              UseRouting(IApplicationBuilder) æ–¹æ³•æœƒå°‡è·¯ç”±ä¸­é–“ä»¶æ–°å¢è‡³è¦æ±‚ç®¡ç·šã€‚ æ­¤ä¸­é–“ä»¶æœƒè™•ç†è·¯ç”±è³‡è¨Šï¼Œä¸¦åˆ¤æ–·æ¯å€‹è¦æ±‚çš„é©ç•¶ç«¯é»ã€‚ é™¤éæ‚¨æƒ³è¦è®Šæ›´ä¸­é–“ä»¶è™•ç†çš„é †åºï¼Œå¦å‰‡æ‚¨ä¸éœ€è¦æ˜ç¢ºå‘¼å« UseRoutingã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core å’Œ ASP.NET Core  è·¯ç”±å’Œç€è¦½ä¸­çš„ è·¯ç”±ã€‚\néŒ¯èª¤è™•ç†\nASP.NET Core å…·æœ‰è™•ç†éŒ¯èª¤çš„å…§å»ºåŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š\n\né–‹ç™¼äººå“¡ä¾‹å¤–ç‹€æ³é é¢\nè‡ªè¨‚éŒ¯èª¤é é¢\néœæ…‹ç‹€æ…‹ç¢¼é é¢\nå•Ÿå‹•ä¾‹å¤–ç‹€æ³è™•ç†\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±è™•ç† ASP.NET Core ä¸­çš„éŒ¯èª¤ã€‚\nç™¼å‡º HTTP è¦æ±‚\n\n              IHttpClientFactory çš„å¯¦ä½œå¯ç”¨æ–¼å»ºç«‹ HttpClient åŸ·è¡Œå€‹é«”ã€‚ Factoryï¼š\n\næä¾›ä¸€å€‹é›†ä¸­ä½ç½®ä»¥ä¾¿å‘½åå’Œè¨­å®šé‚è¼¯ HttpClient åŸ·è¡Œå€‹é«”ã€‚ ä¾‹å¦‚ï¼Œè¨»å†Šä¸¦è¨­å®š Github ç”¨æˆ¶ç«¯ä»¥å­˜å– GitHubã€‚ è¨»å†Šä¸¦è¨­å®šé è¨­ç”¨æˆ¶ç«¯ä»¥ä¾›å…¶ä»–ç”¨é€”ä½¿ç”¨ã€‚\næ”¯æ´è¨»å†ŠåŠå¤šå€‹å§”æ´¾è™•ç†å¸¸å¼çš„éˆçµï¼Œä»¥ç”¨æ–¼å»ºç½®å‚³å‡ºè¦æ±‚ä¸­ä»‹è»Ÿé«”ç®¡ç·šã€‚ æ­¤æ¨¡å¼èˆ‡ ASP.NET Core çš„è¼¸å…¥ä¸­ä»‹è»Ÿé«”ç®¡ç·šç›¸ä¼¼ã€‚ æ¨¡å¼æä¾›ä¸€å€‹æ©Ÿåˆ¶ä¾†ç®¡ç† HTTP è¦æ±‚çš„è·¨é ˜åŸŸé—œæ³¨ï¼ŒåŒ…æ‹¬å¿«å–ã€éŒ¯èª¤è™•ç†ã€åºåˆ—åŒ–å’Œè¨˜éŒ„ã€‚\nèˆ‡ Polly æ•´åˆï¼ŒPolly æ˜¯ä¸€ç¨®ç†±é–€çš„å”åŠ›å» å•†ç¨‹å¼åº«ï¼Œç”¨æ–¼é€²è¡Œæš«æ™‚æ€§çš„éŒ¯èª¤è™•ç†ã€‚\nç®¡ç†åŸºç¤ HttpClientHandler åŸ·è¡Œå€‹é«”çš„å…±ç”¨å’Œå­˜ç•™æœŸï¼Œä»¥é¿å…åœ¨æ‰‹å‹•ç®¡ç† HttpClient å­˜ç•™æœŸæ™‚ï¼Œç™¼ç”Ÿçš„å¸¸è¦‹ DNS å•é¡Œã€‚\né‡å°é€éè™•ç†ç«™æ‰€å»ºç«‹ä¹‹ç”¨æˆ¶ç«¯å‚³é€çš„æ‰€æœ‰è¦æ±‚ï¼Œæ–°å¢å¯è¨­å®šçš„è¨˜éŒ„é«”é©— (é€é ILogger)ã€‚\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä½¿ç”¨ IHttpClientFactory ç™¼å‡º HTTP è¦æ±‚ã€‚\nå…§å®¹æ ¹ç›®éŒ„\nå…§å®¹æ ¹ç›®éŒ„æ˜¯ä¸‹åˆ—é …ç›®çš„åŸºåº•è·¯å¾‘ï¼š\n\nè£è¼‰æ‡‰ç”¨ç¨‹å¼çš„å¯åŸ·è¡Œæª” (.exe)ã€‚\næ§‹æˆæ‡‰ç”¨ç¨‹å¼ (.dll) çš„å·²ç·¨è­¯çµ„ä»¶ã€‚\næ‡‰ç”¨ç¨‹å¼ä½¿ç”¨çš„å…§å®¹æª”æ¡ˆï¼Œä¾‹å¦‚ï¼š\n\n              Razor æª”æ¡ˆ (.cshtmlã€.razor)\nçµ„æ…‹æª” (.jsonã€.xml)\nè³‡æ–™æª”æ¡ˆ (.db)\n\n\n\n              Web æ ¹ç›®éŒ„ï¼Œé€šå¸¸æ˜¯ wwwroot è³‡æ–™å¤¾ã€‚\n\nåœ¨é–‹ç™¼æœŸé–“ï¼Œå…§å®¹æ ¹ç›®éŒ„é è¨­ç‚ºå°ˆæ¡ˆçš„æ ¹ç›®éŒ„ã€‚ æ­¤ç›®éŒ„ä¹Ÿæ˜¯æ‡‰ç”¨ç¨‹å¼å…§å®¹æª”æ¡ˆå’Œ Web æ ¹ç›®éŒ„çš„åŸºåº•è·¯å¾‘ã€‚ æŒ‡å®šä¸åŒçš„å…§å®¹æ ¹ç›®éŒ„ï¼Œæ–¹æ³•æ˜¯åœ¨å»ºç½®ä¸»æ©Ÿæ™‚è¨­å®šå…¶è·¯å¾‘ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±å…§å®¹æ ¹ã€‚\nWeb æ ¹ç›®éŒ„\nWeb æ ¹ç›®éŒ„æ˜¯å…¬ç”¨éœæ…‹è³‡æºæª”çš„åŸºåº•è·¯å¾‘ï¼Œä¾‹å¦‚ï¼š\n\næ¨£å¼è¡¨å–® (.css)\nJavaScript (.js)\næ˜ åƒ (.pngã€.jpg)\n\næ ¹æ“šé è¨­ï¼Œéœæ…‹æª”æ¡ˆåªæœƒè™•ç†ä¾†è‡ª Web æ ¹ç›®éŒ„åŠå…¶å­ç›®éŒ„çš„æª”æ¡ˆã€‚ Web æ ¹è·¯å¾‘é è¨­ç‚º {content root}/wwwrootã€‚ æŒ‡å®šä¸åŒçš„ Web æ ¹ç›®éŒ„ï¼Œæ–¹æ³•æ˜¯åœ¨å»ºç½®ä¸»æ©Ÿæ™‚è¨­å®šå…¶è·¯å¾‘ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± Web æ ¹ç›®éŒ„ã€‚\né˜²æ­¢åœ¨ wwwroot ä¸­ä½¿ç”¨å°ˆæ¡ˆæª”ä¸­çš„>ä¾†ç™¼ä½ˆæª”æ¡ˆã€‚ ä¸‹åˆ—ç¯„ä¾‹æœƒé˜²æ­¢åœ¨ wwwroot/local åŠå…¶å­ç›®éŒ„ä¸­ç™¼ä½ˆå…§å®¹ï¼š\n<ItemGroup>\n  <Content Update=\"wwwroot\\local\\**\\*.*\" CopyToPublishDirectory=\"Never\" />\n</ItemGroup>\n\nåœ¨ Razor.cshtml æª”æ¡ˆä¸­ï¼Œ~/ æœƒæŒ‡å‘ Web æ ¹ç›®éŒ„ã€‚ é–‹é ­ç‚º ~/ çš„è·¯å¾‘ç¨±ç‚ºè™›æ“¬è·¯å¾‘ã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„éœæ…‹æª”æ¡ˆã€‚\nå…¶ä»–è³‡æº\n\n\n              ASP.NET Core Blazor åŸºæœ¬æ¦‚å¿µ\n\n\n\næœ¬æ–‡æä¾›å»ºç½® ASP.NET Core æ‡‰ç”¨ç¨‹å¼çš„åŸºæœ¬æ¦‚å¿µæ¦‚è§€ï¼ŒåŒ…æ‹¬ç›¸ä¾æ€§æ’å…¥ (DI)ã€è¨­å®šã€ä¸­ä»‹è»Ÿé«”ç­‰ç­‰ã€‚\nProgram.cs\nä½¿ç”¨ Web ç¯„æœ¬å»ºç«‹çš„ ASP.NET Core æ‡‰ç”¨ç¨‹å¼åŒ…å« Program.cs æª”æ¡ˆä¸­çš„æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•ç¨‹å¼ç¢¼ã€‚ \n              Program.cs æª”æ¡ˆä½æ–¼ä¸‹åˆ—ä½ç½®ï¼š\n\nå·²è¨­å®šæ‡‰ç”¨ç¨‹å¼æ‰€éœ€çš„æœå‹™ã€‚\næ‡‰ç”¨ç¨‹å¼çš„è¦æ±‚è™•ç†ç®¡ç·šæ˜¯å®šç¾©ç‚ºä¸€ç³»åˆ—ä¸­ä»‹è»Ÿé«”å…ƒä»¶ã€‚\n\nä¸‹åˆ—æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•ç¨‹å¼ç¢¼æ”¯æ´ï¼š\n\n\n              \n              Razor Pages\n\n              MVC æ§åˆ¶å™¨èˆ‡æª¢è¦–\n\n              Web API èˆ‡æ§åˆ¶å™¨\n\n              æœ€å° web API\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\n\napp.UseAuthorization();\n\napp.MapGet(\"/hi\", () => \"Hello!\");\n\napp.MapDefaultControllerRoute();\napp.MapRazorPages();\n\napp.Run();\nç›¸ä¾æ€§æ’å…¥ (æœå‹™)\nASP.NET Core åŒ…å«ç›¸ä¾æ€§æ’å…¥ (DI)ï¼Œå¯è®“æ•´å€‹æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨æ‰€è¨­å®šæœå‹™ã€‚ åœ¨ä¸Šè¿°ç¨‹å¼ç¢¼ä¸­ï¼Œæœå‹™æœƒæ–°å¢è‡³å…·æœ‰ WebApplicationBuilder.Servicesã€builder.Services çš„ DI å®¹å™¨ã€‚ å…·ç¾åŒ– WebApplicationBuilder æ™‚ï¼Œæœƒæ–°å¢è¨±å¤šæ¶æ§‹æ‰€æä¾›çš„æœå‹™ã€‚ \n              builder æ˜¯ä¸‹åˆ—ç¨‹å¼ç¢¼ä¸­çš„ WebApplicationBuilderï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\nåœ¨ä¸Šè¿°åç™½é¡¯ç¤ºçš„ç¨‹å¼ç¢¼ä¸­ï¼Œbuilder å·²å°‡çµ„æ…‹ã€è¨˜éŒ„å’Œè¨±å¤šå…¶ä»–æœå‹™æ–°å¢è‡³ DI å®¹å™¨ã€‚\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒå°‡ Razor Pagesã€å…·æœ‰æª¢è¦–çš„ MVC æ§åˆ¶å™¨ï¼Œä»¥åŠè‡ªè¨‚çš„ DbContext æ–°å¢è‡³ DI å®¹å™¨ï¼š\nusing Microsoft.EntityFrameworkCore;\nusing RazorPagesMovie.Data;\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nbuilder.Services.AddDbContext<RazorPagesMovieContext>(options =>\n   options.UseSqlServer(builder.Configuration.GetConnectionString(\"RPMovieContext\")));\n\nvar app = builder.Build();\n\né€šå¸¸æœƒä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥å¾ DI è§£ææœå‹™ã€‚ DI æ¶æ§‹æœƒåœ¨åŸ·è¡Œéšæ®µæä¾›æ­¤æœå‹™çš„åŸ·è¡Œå€‹é«”ã€‚\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥ï¼Œå¾ DI è§£æè³‡æ–™åº«å…§å®¹å’Œè¨˜éŒ„å™¨ï¼š\npublic class IndexModel : PageModel\n{\n    private readonly RazorPagesMovieContext _context;\n    private readonly ILogger<IndexModel> _logger;\n\n    public IndexModel(RazorPagesMovieContext context, ILogger<IndexModel> logger)\n    {\n        _context = context;\n        _logger = logger;\n    }\n\n    public IList<Movie> Movie { get;set; }\n\n    public async Task OnGetAsync()\n    {\n        _logger.LogInformation(\"IndexModel OnGetAsync.\");\n        Movie = await _context.Movie.ToListAsync();\n    }\n}\nä¸­ä»‹è»Ÿé«”\nè¦æ±‚è™•ç†ç®¡ç·šç”±ä¸€ç³»åˆ—ä¸­ä»‹è»Ÿé«”å…ƒä»¶æ‰€çµ„æˆã€‚ æ¯å€‹å…ƒä»¶æœƒåœ¨ HttpContext ä¸ŠåŸ·è¡Œæ“ä½œï¼Œä¸¦å«ç”¨ç®¡ç·šä¸­ä¸‹ä¸€å€‹ä¸­ä»‹è»Ÿé«”æˆ–çµ‚æ­¢è¦æ±‚ã€‚\nä¾ç…§æ…£ä¾‹ï¼Œä¸­ä»‹è»Ÿé«”å…ƒä»¶æœƒé€éå«ç”¨ Use{Feature} å»¶ä¼¸æ¨¡çµ„æ–¹æ³•ä¾†æ–°å¢è‡³ç®¡ç·šã€‚ ä¸‹åˆ—ç¨‹å¼ç¢¼ä¸­æœƒå°‡æ–°å¢è‡³æ‡‰ç”¨ç¨‹å¼çš„ä¸­ä»‹è»Ÿé«”åç™½é¡¯ç¤ºï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\n\napp.UseAuthorization();\n\napp.MapGet(\"/hi\", () => \"Hello!\");\n\napp.MapDefaultControllerRoute();\napp.MapRazorPages();\n\napp.Run();\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­ä»‹è»Ÿé«”ã€‚\nHost\nåœ¨å•Ÿå‹•æ™‚ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼æœƒå»ºç½®ä¸€å€‹ã€Œä¸»æ©Ÿã€ã€‚ ä¸»æ©Ÿæœƒå°è£æ‰€æœ‰æ‡‰ç”¨ç¨‹å¼çš„è³‡æºï¼Œä¾‹å¦‚ï¼š\n\nHTTP ä¼ºæœå™¨å¯¦ä½œ\nä¸­ä»‹è»Ÿé«”å…ƒä»¶\nè¨˜éŒ„\nç›¸ä¾æ€§æ’å…¥ (æœå‹™)\nçµ„æ…‹\n\næœ‰ä¸‰å€‹ä¸åŒçš„ä¸»æ©Ÿèƒ½å¤ åŸ·è¡Œ ASP.NET Core æ‡‰ç”¨ç¨‹å¼ï¼š\n\n\n              ASP.NET Core WebApplicationï¼Œä¹Ÿç¨±ç‚ºæœ€å°ä¸»æ©Ÿ\nçµåˆ ASP.NET Core  çš„ ConfigureWebHostDefaults\n\n              ASP.NET Core WebHost\n\nå»ºè­°ä½¿ç”¨ ASP.NET Core WebApplication å’Œ WebApplicationBuilder é¡å‹ï¼Œä¸¦ç”¨æ–¼æ‰€æœ‰ ASP.NET Core ç¯„æœ¬ã€‚ \n              WebApplication çš„é‹ä½œæ–¹å¼èˆ‡ .NET æ³›å‹ä¸»æ©Ÿé¡ä¼¼ï¼Œä¸¦å…¬é–‹è¨±å¤šç›¸åŒçš„ä»‹é¢ï¼Œä½†éœ€è¦è¼ƒå°‘çš„å›å‘¼é€²è¡Œè¨­å®šã€‚ ASP.NET Core WebHost åƒ…é©ç”¨æ–¼å›æº¯ç›¸å®¹æ€§ã€‚\nä¸‹åˆ—ç¯„ä¾‹æœƒå…·ç¾åŒ– WebApplicationï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\n\n              WebApplicationBuilder.Build æ–¹æ³•æœƒä½¿ç”¨ä¸€çµ„é è¨­é¸é …ä¾†è¨­å®šä¸»æ©Ÿï¼Œä¾‹å¦‚ï¼š\n\nä½¿ç”¨ Kestrel åšç‚ºç¶²é ä¼ºæœå™¨ï¼Œä¸¦å•Ÿç”¨ IIS æ•´åˆã€‚\nå¾ ã€ç’°å¢ƒè®Šæ•¸ã€å‘½ä»¤åˆ—å¼•æ•¸åŠå…¶ä»–ä¾†æºè¼‰å…¥appsettings.jsonã€‚\nå°‡è¨˜éŒ„è¼¸å‡ºå‚³é€åˆ°ä¸»æ§å°åŠåµéŒ¯æä¾›è€…ã€‚\n\né Web æ¡ˆä¾‹\nä¸€èˆ¬ä¸»æ©Ÿå…è¨±å…¶ä»–é¡å‹çš„æ‡‰ç”¨ç¨‹å¼ï¼Œä½¿ç”¨äº¤å‰å‰ªè¼¯æ¶æ§‹å»¶ä¼¸æ¨¡çµ„ï¼Œä¾‹å¦‚è¨˜éŒ„ã€ç›¸ä¾æ€§æ’å…¥ (DI)ã€è¨­å®šèˆ‡æ‡‰ç”¨ç¨‹å¼å­˜ç•™æœŸç®¡ç†ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„ .NET æ³›å‹ä¸»æ©Ÿï¼Œä»¥åŠåœ¨ ASP.NET Core ä¸­ä½¿ç”¨è¨—ç®¡æœå‹™çš„èƒŒæ™¯å·¥ä½œã€‚\nä¼ºæœå™¨\nASP.NET Core æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨ HTTP ä¼ºæœå™¨å¯¦ä½œä¾†æ¥è½ HTTP è¦æ±‚ã€‚ ä¼ºæœå™¨æœƒæŠŠå‘æ‡‰ç”¨ç¨‹å¼ç™¼å‡ºçš„è¦æ±‚ä½œç‚ºä¸€çµ„è¦æ±‚åŠŸèƒ½ï¼Œåˆä½µæˆä¸€å€‹ HttpContextã€‚\n\n\n\n\n              Windows\n\n\n\n              macOS\n\n\n\n              Linux\n\n\n\n\nASP.NET Core éš¨é™„ä¸‹åˆ—ä¼ºæœå™¨å¯¦ä½œï¼š\n\n\n              Kestrel æ˜¯è·¨å¹³å°çš„ç¶²é ä¼ºæœå™¨ã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ IIS åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚\n\n              IIS HTTP ä¼ºæœå™¨å‰‡æ˜¯é©ç”¨æ–¼ä½¿ç”¨ IIS Windows çš„ä¼ºæœå™¨ã€‚ é€éæ­¤ä¼ºæœå™¨ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼åŠ IIS ä¾¿å¯ä»¥åœ¨ç›¸åŒè™•ç†åºä¸­åŸ·è¡Œã€‚\n\n              HTTP.sys å‰‡æ˜¯é©ç”¨æ–¼ä¸¦æœªæ­é… IIS ä½¿ç”¨ Windows çš„ä¼ºæœå™¨ã€‚\n\n\n\n\nASP.NET Core æä¾› Kestrel è·¨å¹³å°ä¼ºæœå™¨å¯¦ä½œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ Nginx æˆ– Apache åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚\n\n\n\nASP.NET Core æä¾› Kestrel è·¨å¹³å°ä¼ºæœå™¨å¯¦ä½œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ Nginx æˆ– Apache åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚\n\n\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­å¯¦ä½œç¶²é ä¼ºæœå™¨ã€‚\nçµ„æ…‹\nASP.NET Core æä¾›çµ„æ…‹æ¶æ§‹ï¼Œå¯å¾çµ„æ…‹æä¾›è€…çš„å·²æ’åºé›†åˆä¸­ï¼Œä»¥æˆå°åç¨±å’Œæ•¸å€¼çš„å½¢å¼å–å¾—è¨­å®šã€‚ æ‚¨å¯ä»¥ä½¿ç”¨å„ç¨®ä¾†æºçš„å…§å»ºçµ„æ…‹æä¾›è€…ï¼Œä¾‹å¦‚ .json æª”æ¡ˆã€.xml æª”æ¡ˆã€ç’°å¢ƒè®Šæ•¸åŠå‘½ä»¤åˆ—å¼•æ•¸ã€‚ æ’°å¯«è‡ªè¨‚çµ„æ…‹æä¾›è€…ä»¥æ”¯æ´å…¶ä»–ä¾†æºã€‚\næ ¹æ“šé è¨­ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼æœƒè¨­å®šç‚ºå¾ appsettings.jsonã€ç’°å¢ƒè®Šæ•¸ã€å‘½ä»¤åˆ—ç­‰é€²è¡Œè®€å–ã€‚ è¼‰å…¥æ‡‰ç”¨ç¨‹å¼çš„çµ„æ…‹æ™‚ï¼Œä¾†è‡ªç’°å¢ƒè®Šæ•¸çš„å€¼æœƒè¦†å¯«ä¾†è‡ª appsettings.json çš„å€¼ã€‚\né‡å°ç®¡ç†ä¿å¯†çµ„æ…‹è³‡æ–™ (ä¾‹å¦‚å¯†ç¢¼)ï¼Œ.NET Core æä¾›ç¥•å¯†ç®¡ç†å“¡ã€‚ é‡å°ç”Ÿç”¢ç¥•å¯†ï¼Œæˆ‘å€‘å»ºè­°ä½¿ç”¨ Azure Key Vaultã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„çµ„æ…‹ã€‚\nç’°å¢ƒ\nASP.NET Core ä¸­æä¾›åŸ·è¡Œç’°å¢ƒï¼Œä¾‹å¦‚ Developmentã€Staging å’Œ Productionã€‚ é€éè¨­å®š ASPNETCORE_ENVIRONMENT ç’°å¢ƒè®Šæ•¸ä¾†æŒ‡å®šæ‡‰ç”¨ç¨‹å¼åŸ·è¡Œçš„ç’°å¢ƒã€‚ ASP.NET Core æœƒåœ¨æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•æ™‚è®€å–ç’°å¢ƒè®Šæ•¸ï¼Œç„¶å¾Œå°‡å€¼å„²å­˜åœ¨ IWebHostEnvironment å¯¦ä½œä¸­ã€‚ æ‚¨å¯åœ¨æ‡‰ç”¨ç¨‹å¼ä¸­é€éç›¸ä¾æ€§æ’å…¥ (DI) å–å¾—æ­¤å¯¦ä½œã€‚\nä¸‹åˆ—ç¯„ä¾‹æœƒåœ¨æœªæ–¼  ç’°å¢ƒä¸­åŸ·è¡Œæ™‚ï¼Œè¨­å®šä¾‹å¤–è™•ç†å¸¸å¼å’Œ Development ä¸­ä»‹è»Ÿé«”ï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\n\napp.UseAuthorization();\n\napp.MapGet(\"/hi\", () => \"Hello!\");\n\napp.MapDefaultControllerRoute();\napp.MapRazorPages();\n\napp.Run();\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä½¿ç”¨å¤šå€‹ç’°å¢ƒ (éƒ¨åˆ†æ©Ÿå™¨ç¿»è­¯)ã€‚\nè¨˜éŒ„\nASP.NET Core æ”¯æ´è¨˜éŒ„ APIï¼Œæ­¤ API èƒ½èˆ‡å„ç¨®å…§å»ºå’Œç¬¬ä¸‰æ–¹è¨˜éŒ„æä¾›è€…æ­é…ä½¿ç”¨ã€‚ å¯ç”¨çš„æä¾›è€…åŒ…æ‹¬ï¼š\n\nä¸»æ§å°\nåµéŒ¯\nWindows ä¸Šçš„äº‹ä»¶è¿½è¹¤\nWindows äº‹ä»¶è¨˜éŒ„æª”\nTraceSource\nAzure App Service\nAzure Application Insights\n\nè‹¥è¦å»ºç«‹è¨˜éŒ„ï¼ŒILogger<TCategoryName>è«‹å¾ç›¸ä¾æ€§æ’å…¥ (DI) å’Œé€šè©±è¨˜éŒ„æ–¹æ³• (ä¾‹å¦‚ LogInformation) è§£ææœå‹™ã€‚ ä¾‹å¦‚ï¼š\npublic class IndexModel : PageModel\n{\n    private readonly RazorPagesMovieContext _context;\n    private readonly ILogger<IndexModel> _logger;\n\n    public IndexModel(RazorPagesMovieContext context, ILogger<IndexModel> logger)\n    {\n        _context = context;\n        _logger = logger;\n    }\n\n    public IList<Movie> Movie { get;set; }\n\n    public async Task OnGetAsync()\n    {\n        _logger.LogInformation(\"IndexModel OnGetAsync.\");\n        Movie = await _context.Movie.ToListAsync();\n    }\n}\n\nå¦‚éœ€è©³ç´°è³‡æ–™ï¼Œè«‹åƒé–± .NET Core èˆ‡ ASP.NET Core ä¸­çš„è¨˜éŒ„ã€‚\nè·¯ç”±\nã€Œè·¯ç”±ã€æ˜¯ä¸€ç¨®å°æ‡‰åˆ°è™•ç†å¸¸å¼çš„ URL æ¨¡å¼ã€‚ è™•ç†å¸¸å¼é€šå¸¸æ˜¯ Razor é é¢ã€MVC æ§åˆ¶å™¨ä¸­çš„å‹•ä½œæ–¹æ³•ï¼Œæˆ–æ˜¯ä¸­ä»‹è»Ÿé«”ã€‚ ASP.NET Core è·¯ç”±å¯è®“æ‚¨æ§åˆ¶æ‚¨æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨çš„ URLã€‚\nASP.NET Core Web æ‡‰ç”¨ç¨‹å¼ç¯„æœ¬æ‰€ç”¢ç”Ÿçš„ä¸‹åˆ—ç¨‹å¼ç¢¼æœƒå‘¼å« UseRoutingï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\nbuilder.Services.AddRazorPages();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\n\napp.UseRouting();\n\napp.UseAuthorization();\n\napp.MapRazorPages();\n\napp.Run();\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„è·¯ç·šè¦åŠƒã€‚\néŒ¯èª¤è™•ç†\nASP.NET Core å…·æœ‰è™•ç†éŒ¯èª¤çš„å…§å»ºåŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š\n\né–‹ç™¼äººå“¡ä¾‹å¤–ç‹€æ³é é¢\nè‡ªè¨‚éŒ¯èª¤é é¢\néœæ…‹ç‹€æ…‹ç¢¼é é¢\nå•Ÿå‹•ä¾‹å¤–ç‹€æ³è™•ç†\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±è™•ç† ASP.NET Core ä¸­çš„éŒ¯èª¤ã€‚\nç™¼å‡º HTTP è¦æ±‚\n\n              IHttpClientFactory çš„å¯¦ä½œå¯ç”¨æ–¼å»ºç«‹ HttpClient åŸ·è¡Œå€‹é«”ã€‚ Factoryï¼š\n\næä¾›ä¸€å€‹é›†ä¸­ä½ç½®ä»¥ä¾¿å‘½åå’Œè¨­å®šé‚è¼¯ HttpClient åŸ·è¡Œå€‹é«”ã€‚ ä¾‹å¦‚ï¼Œè¨»å†Šä¸¦è¨­å®š Github ç”¨æˆ¶ç«¯ä»¥å­˜å– GitHubã€‚ è¨»å†Šä¸¦è¨­å®šé è¨­ç”¨æˆ¶ç«¯ä»¥ä¾›å…¶ä»–ç”¨é€”ä½¿ç”¨ã€‚\næ”¯æ´è¨»å†ŠåŠå¤šå€‹å§”æ´¾è™•ç†å¸¸å¼çš„éˆçµï¼Œä»¥ç”¨æ–¼å»ºç½®å‚³å‡ºè¦æ±‚ä¸­ä»‹è»Ÿé«”ç®¡ç·šã€‚ æ­¤æ¨¡å¼èˆ‡ ASP.NET Core çš„è¼¸å…¥ä¸­ä»‹è»Ÿé«”ç®¡ç·šç›¸ä¼¼ã€‚ æ¨¡å¼æä¾›ä¸€å€‹æ©Ÿåˆ¶ä¾†ç®¡ç† HTTP è¦æ±‚çš„è·¨é ˜åŸŸé—œæ³¨ï¼ŒåŒ…æ‹¬å¿«å–ã€éŒ¯èª¤è™•ç†ã€åºåˆ—åŒ–å’Œè¨˜éŒ„ã€‚\nèˆ‡ Polly æ•´åˆï¼ŒPolly æ˜¯ä¸€ç¨®ç†±é–€çš„å”åŠ›å» å•†ç¨‹å¼åº«ï¼Œç”¨æ–¼é€²è¡Œæš«æ™‚æ€§çš„éŒ¯èª¤è™•ç†ã€‚\nç®¡ç†åŸºç¤ HttpClientHandler åŸ·è¡Œå€‹é«”çš„å…±ç”¨å’Œå­˜ç•™æœŸï¼Œä»¥é¿å…åœ¨æ‰‹å‹•ç®¡ç† HttpClient å­˜ç•™æœŸæ™‚ï¼Œç™¼ç”Ÿçš„å¸¸è¦‹ DNS å•é¡Œã€‚\né‡å°é€éè™•ç†ç«™æ‰€å»ºç«‹ä¹‹ç”¨æˆ¶ç«¯å‚³é€çš„æ‰€æœ‰è¦æ±‚ï¼Œæ–°å¢å¯è¨­å®šçš„è¨˜éŒ„é«”é©— (é€é ILogger)ã€‚\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä½¿ç”¨ IHttpClientFactory ç™¼å‡º HTTP è¦æ±‚ã€‚\nå…§å®¹æ ¹ç›®éŒ„\nå…§å®¹æ ¹ç›®éŒ„æ˜¯ä¸‹åˆ—é …ç›®çš„åŸºåº•è·¯å¾‘ï¼š\n\nè£è¼‰æ‡‰ç”¨ç¨‹å¼çš„å¯åŸ·è¡Œæª” (.exe)ã€‚\næ§‹æˆæ‡‰ç”¨ç¨‹å¼ (.dll) çš„å·²ç·¨è­¯çµ„ä»¶ã€‚\næ‡‰ç”¨ç¨‹å¼ä½¿ç”¨çš„å…§å®¹æª”æ¡ˆï¼Œä¾‹å¦‚ï¼š\n\n              Razor æª”æ¡ˆ (.cshtmlã€.razor)\nçµ„æ…‹æª” (.jsonã€.xml)\nè³‡æ–™æª”æ¡ˆ (.db)\n\n\n\n              Web æ ¹ç›®éŒ„ï¼Œé€šå¸¸æ˜¯ wwwroot è³‡æ–™å¤¾ã€‚\n\nåœ¨é–‹ç™¼æœŸé–“ï¼Œå…§å®¹æ ¹ç›®éŒ„é è¨­ç‚ºå°ˆæ¡ˆçš„æ ¹ç›®éŒ„ã€‚ æ­¤ç›®éŒ„ä¹Ÿæ˜¯æ‡‰ç”¨ç¨‹å¼å…§å®¹æª”æ¡ˆå’Œ Web æ ¹ç›®éŒ„çš„åŸºåº•è·¯å¾‘ã€‚ æŒ‡å®šä¸åŒçš„å…§å®¹æ ¹ç›®éŒ„ï¼Œæ–¹æ³•æ˜¯åœ¨å»ºç½®ä¸»æ©Ÿæ™‚è¨­å®šå…¶è·¯å¾‘ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±å…§å®¹æ ¹ã€‚\nWeb æ ¹ç›®éŒ„\nWeb æ ¹ç›®éŒ„æ˜¯å…¬ç”¨éœæ…‹è³‡æºæª”çš„åŸºåº•è·¯å¾‘ï¼Œä¾‹å¦‚ï¼š\n\næ¨£å¼è¡¨å–® (.css)\nJavaScript (.js)\næ˜ åƒ (.pngã€.jpg)\n\næ ¹æ“šé è¨­ï¼Œéœæ…‹æª”æ¡ˆåªæœƒè™•ç†ä¾†è‡ª Web æ ¹ç›®éŒ„åŠå…¶å­ç›®éŒ„çš„æª”æ¡ˆã€‚ Web æ ¹è·¯å¾‘é è¨­ç‚º {content root}/wwwrootã€‚ æŒ‡å®šä¸åŒçš„ Web æ ¹ç›®éŒ„ï¼Œæ–¹æ³•æ˜¯åœ¨å»ºç½®ä¸»æ©Ÿæ™‚è¨­å®šå…¶è·¯å¾‘ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± Web æ ¹ç›®éŒ„ã€‚\né˜²æ­¢åœ¨ wwwroot ä¸­ä½¿ç”¨å°ˆæ¡ˆæª”ä¸­çš„>ä¾†ç™¼ä½ˆæª”æ¡ˆã€‚ ä¸‹åˆ—ç¯„ä¾‹æœƒé˜²æ­¢åœ¨ wwwroot/local åŠå…¶å­ç›®éŒ„ä¸­ç™¼ä½ˆå…§å®¹ï¼š\n<ItemGroup>\n  <Content Update=\"wwwroot\\local\\**\\*.*\" CopyToPublishDirectory=\"Never\" />\n</ItemGroup>\n\nåœ¨ Razor.cshtml æª”æ¡ˆä¸­ï¼Œ~/ æœƒæŒ‡å‘ Web æ ¹ç›®éŒ„ã€‚ é–‹é ­ç‚º ~/ çš„è·¯å¾‘ç¨±ç‚ºè™›æ“¬è·¯å¾‘ã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„éœæ…‹æª”æ¡ˆã€‚\nå…¶ä»–è³‡æº\n\n\n              WebApplicationBuilder åŸå§‹ç¨‹å¼ç¢¼\n\n\n\næœ¬æ–‡æä¾›å»ºç½® ASP.NET Core æ‡‰ç”¨ç¨‹å¼çš„åŸºæœ¬æ¦‚å¿µæ¦‚è§€ï¼ŒåŒ…æ‹¬ç›¸ä¾æ€§æ’å…¥ (DI)ã€è¨­å®šã€ä¸­ä»‹è»Ÿé«”ç­‰ç­‰ã€‚\nStartup é¡åˆ¥\n\n              Startup é¡åˆ¥æ˜¯ï¼š\n\nå·²è¨­å®šæ‡‰ç”¨ç¨‹å¼æ‰€éœ€çš„æœå‹™ã€‚\næ‡‰ç”¨ç¨‹å¼çš„è¦æ±‚è™•ç†ç®¡ç·šæ˜¯å®šç¾©ç‚ºä¸€ç³»åˆ—ä¸­ä»‹è»Ÿé«”å…ƒä»¶ã€‚\n\nä»¥ä¸‹æ˜¯ Startup é¡åˆ¥ç¯„ä¾‹ï¼š\npublic class Startup\n{\n    public void ConfigureServices(IServiceCollection services)\n    {\n        services.AddDbContext<RazorPagesMovieContext>(options =>\n            options.UseSqlServer(Configuration.GetConnectionString(\"RazorPagesMovieContext\")));\n\n        services.AddControllersWithViews();\n        services.AddRazorPages();\n    }\n\n    public void Configure(IApplicationBuilder app)\n    {\n        app.UseHttpsRedirection();\n        app.UseStaticFiles();\n\n        app.UseRouting();\n\n        app.UseEndpoints(endpoints =>\n        {\n            endpoints.MapDefaultControllerRoute();\n            endpoints.MapRazorPages();\n        });\n    }\n}\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•ã€‚\nç›¸ä¾æ€§æ’å…¥ (æœå‹™)\nASP.NET Core åŒ…å«å…§å»ºçš„ç›¸ä¾æ€§æ’å…¥ (DI) æ¶æ§‹ï¼Œå¯è®“æ•´å€‹æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨æ‰€è¨­å®šæœå‹™ã€‚ ä¾‹å¦‚ï¼Œè¨˜éŒ„å…ƒä»¶å³ç‚ºä¸€é …æœå‹™ã€‚\nè¨­å®š (æˆ–ã€Œè¨»å†Šã€) æœå‹™çš„ç¨‹å¼ç¢¼æœƒæ–°å¢è‡³ Startup.ConfigureServices æ–¹æ³•ã€‚ ä¾‹å¦‚ï¼š\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddDbContext<RazorPagesMovieContext>(options =>\n        options.UseSqlServer(Configuration.GetConnectionString(\"RazorPagesMovieContext\")));\n\n    services.AddControllersWithViews();\n    services.AddRazorPages();\n}\n\né€šå¸¸æœƒä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥å¾ DI è§£ææœå‹™ã€‚ é¡åˆ¥æœƒä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥ä¾†å®£å‘Šå¿…è¦é¡å‹æˆ–ä»‹é¢çš„å»ºæ§‹å‡½å¼åƒæ•¸ã€‚ DI æ¶æ§‹æœƒåœ¨åŸ·è¡Œéšæ®µæä¾›æ­¤æœå‹™çš„åŸ·è¡Œå€‹é«”ã€‚\nä¸‹åˆ—ç¯„ä¾‹æœƒä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥å¾ DI è§£æ RazorPagesMovieContextï¼š\npublic class IndexModel : PageModel\n{\n    private readonly RazorPagesMovieContext _context;\n\n    public IndexModel(RazorPagesMovieContext context)\n    {\n        _context = context;\n    }\n\n    // ...\n\n    public async Task OnGetAsync()\n    {\n        Movies = await _context.Movies.ToListAsync();\n    }\n}\n\nå¦‚æœå…§å»ºçš„æ§åˆ¶åè½‰ (IoC) å®¹å™¨ä¸ç¬¦åˆæ‡‰ç”¨ç¨‹å¼çš„æ‰€æœ‰éœ€æ±‚ï¼Œå‰‡å¯ä»¥æ”¹ç”¨å”åŠ›å» å•† IoC å®¹å™¨ã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­æ’å…¥ç›¸ä¾æ€§ã€‚\nä¸­ä»‹è»Ÿé«”\nè¦æ±‚è™•ç†ç®¡ç·šç”±ä¸€ç³»åˆ—ä¸­ä»‹è»Ÿé«”å…ƒä»¶æ‰€çµ„æˆã€‚ æ¯å€‹å…ƒä»¶æœƒåœ¨ HttpContext ä¸ŠåŸ·è¡Œæ“ä½œï¼Œä¸¦å«ç”¨ç®¡ç·šä¸­ä¸‹ä¸€å€‹ä¸­ä»‹è»Ÿé«”æˆ–çµ‚æ­¢è¦æ±‚ã€‚\nä¾ç…§æ…£ä¾‹ï¼Œä¸­ä»‹è»Ÿé«”å…ƒä»¶æœƒé€éå«ç”¨ Use... æ–¹æ³•ä¸­çš„ Startup.Configure å»¶ä¼¸æ¨¡çµ„æ–¹æ³•ä¾†æ–°å¢è‡³ç®¡ç·šã€‚ ä¾‹å¦‚ï¼Œè‹¥è¦å•Ÿç”¨éœæ…‹æª”æ¡ˆè½‰è­¯ï¼Œè«‹å‘¼å« UseStaticFilesã€‚\nä¸‹åˆ—ç¯„ä¾‹æœƒè¨­å®šè¦æ±‚è™•ç†ç®¡ç·šï¼š\npublic void Configure(IApplicationBuilder app)\n{\n    app.UseHttpsRedirection();\n    app.UseStaticFiles();\n\n    app.UseRouting();\n\n    app.UseEndpoints(endpoints =>\n    {\n        endpoints.MapDefaultControllerRoute();\n        endpoints.MapRazorPages();\n    });\n}\n\nASP.NET Core å…§å«ä¸€çµ„è±å¯Œçš„å…§å»ºä¸­ä»‹è»Ÿé«”ã€‚ æ‚¨ä¹Ÿå¯ä»¥æ’°å¯«è‡ªè¨‚ä¸­ä»‹è»Ÿé«”å…ƒä»¶ã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­ä»‹è»Ÿé«”ã€‚\nHost\nåœ¨å•Ÿå‹•æ™‚ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼æœƒå»ºç½®ä¸€å€‹ã€Œä¸»æ©Ÿã€ã€‚ ä¸»æ©Ÿæœƒå°è£æ‰€æœ‰æ‡‰ç”¨ç¨‹å¼çš„è³‡æºï¼Œä¾‹å¦‚ï¼š\n\nHTTP ä¼ºæœå™¨å¯¦ä½œ\nä¸­ä»‹è»Ÿé«”å…ƒä»¶\nè¨˜éŒ„\nç›¸ä¾æ€§æ’å…¥ (æœå‹™)\nçµ„æ…‹\n\næœ‰å…©å€‹ä¸åŒçš„ä¸»æ©Ÿï¼š\n\n.NET æ³›å‹ä¸»æ©Ÿ\nASP.NET Core Web ä¸»æ©Ÿ\n\nå»ºè­°ä½¿ç”¨ .NET æ³›å‹ä¸»æ©Ÿã€‚ ASP.NET Core Web ä¸»æ©Ÿåƒ…é©ç”¨æ–¼å›æº¯ç›¸å®¹æ€§ã€‚\nä¸‹åˆ—ç¯„ä¾‹æœƒå»ºç«‹ .NET æ³›å‹ä¸»æ©Ÿï¼š\npublic class Program\n{\n    public static void Main(string[] args)\n    {\n        CreateHostBuilder(args).Build().Run();\n    }\n\n    public static IHostBuilder CreateHostBuilder(string[] args) =>\n        Host.CreateDefaultBuilder(args)\n            .ConfigureWebHostDefaults(webBuilder =>\n            {\n                webBuilder.UseStartup<Startup>();\n            });\n}\n\n\n              CreateDefaultBuilder å’Œ ConfigureWebHostDefaults æ–¹æ³•æœƒä½¿ç”¨ä¸€çµ„é è¨­é¸é …ä¾†è¨­å®šä¸»æ©Ÿï¼Œä¾‹å¦‚ï¼š\n\nä½¿ç”¨ Kestrel åšç‚ºç¶²é ä¼ºæœå™¨ï¼Œä¸¦å•Ÿç”¨ IIS æ•´åˆã€‚\nå¾ appsettings.jsonã€appsettings.{Environment}.jsonã€ç’°å¢ƒè®Šæ•¸ã€å‘½ä»¤åˆ—å¼•æ•¸åŠå…¶ä»–ä¾†æºè¼‰å…¥çµ„æ…‹ã€‚\nå°‡è¨˜éŒ„è¼¸å‡ºå‚³é€åˆ°ä¸»æ§å°åŠåµéŒ¯æä¾›è€…ã€‚\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET ä¸­çš„ .NET æ³›å‹ä¸»æ©Ÿã€‚\né Web æ¡ˆä¾‹\nä¸€èˆ¬ä¸»æ©Ÿå…è¨±å…¶ä»–é¡å‹çš„æ‡‰ç”¨ç¨‹å¼ï¼Œä½¿ç”¨äº¤å‰å‰ªè¼¯æ¶æ§‹å»¶ä¼¸æ¨¡çµ„ï¼Œä¾‹å¦‚è¨˜éŒ„ã€ç›¸ä¾æ€§æ’å…¥ (DI)ã€è¨­å®šèˆ‡æ‡‰ç”¨ç¨‹å¼å­˜ç•™æœŸç®¡ç†ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„ .NET æ³›å‹ä¸»æ©Ÿï¼Œä»¥åŠåœ¨ ASP.NET Core ä¸­ä½¿ç”¨è¨—ç®¡æœå‹™çš„èƒŒæ™¯å·¥ä½œã€‚\nä¼ºæœå™¨\nASP.NET Core æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨ HTTP ä¼ºæœå™¨å¯¦ä½œä¾†æ¥è½ HTTP è¦æ±‚ã€‚ ä¼ºæœå™¨æœƒæŠŠå‘æ‡‰ç”¨ç¨‹å¼ç™¼å‡ºçš„è¦æ±‚ä½œç‚ºä¸€çµ„è¦æ±‚åŠŸèƒ½ï¼Œåˆä½µæˆä¸€å€‹ HttpContextã€‚\n\n\n\n\n              Windows\n\n\n\n              macOS\n\n\n\n              Linux\n\n\n\n\nASP.NET Core éš¨é™„ä¸‹åˆ—ä¼ºæœå™¨å¯¦ä½œï¼š\n\n\n              Kestrel æ˜¯è·¨å¹³å°çš„ç¶²é ä¼ºæœå™¨ã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ IIS åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚\n\n              IIS HTTP ä¼ºæœå™¨å‰‡æ˜¯é©ç”¨æ–¼ä½¿ç”¨ IIS Windows çš„ä¼ºæœå™¨ã€‚ é€éæ­¤ä¼ºæœå™¨ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼åŠ IIS ä¾¿å¯ä»¥åœ¨ç›¸åŒè™•ç†åºä¸­åŸ·è¡Œã€‚\n\n              HTTP.sys å‰‡æ˜¯é©ç”¨æ–¼ä¸¦æœªæ­é… IIS ä½¿ç”¨ Windows çš„ä¼ºæœå™¨ã€‚\n\n\n\n\nASP.NET Core æä¾› Kestrel è·¨å¹³å°ä¼ºæœå™¨å¯¦ä½œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ Nginx æˆ– Apache åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚\n\n\n\nASP.NET Core æä¾› Kestrel è·¨å¹³å°ä¼ºæœå™¨å¯¦ä½œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ Nginx æˆ– Apache åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚\n\n\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­å¯¦ä½œç¶²é ä¼ºæœå™¨ã€‚\nçµ„æ…‹\nASP.NET Core æä¾›çµ„æ…‹æ¶æ§‹ï¼Œå¯å¾çµ„æ…‹æä¾›è€…çš„å·²æ’åºé›†åˆä¸­ï¼Œä»¥æˆå°åç¨±å’Œæ•¸å€¼çš„å½¢å¼å–å¾—è¨­å®šã€‚ æ‚¨å¯ä»¥ä½¿ç”¨å„ç¨®ä¾†æºçš„å…§å»ºçµ„æ…‹æä¾›è€…ï¼Œä¾‹å¦‚ .json æª”æ¡ˆã€.xml æª”æ¡ˆã€ç’°å¢ƒè®Šæ•¸åŠå‘½ä»¤åˆ—å¼•æ•¸ã€‚ æ’°å¯«è‡ªè¨‚çµ„æ…‹æä¾›è€…ä»¥æ”¯æ´å…¶ä»–ä¾†æºã€‚\næ ¹æ“šé è¨­ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼æœƒè¨­å®šç‚ºå¾ appsettings.jsonã€ç’°å¢ƒè®Šæ•¸ã€å‘½ä»¤åˆ—ç­‰é€²è¡Œè®€å–ã€‚ è¼‰å…¥æ‡‰ç”¨ç¨‹å¼çš„çµ„æ…‹æ™‚ï¼Œä¾†è‡ªç’°å¢ƒè®Šæ•¸çš„å€¼æœƒè¦†å¯«ä¾†è‡ª appsettings.json çš„å€¼ã€‚\nè®€å–ç›¸é—œè¨­å®šå€¼çš„æ…£ç”¨æ–¹å¼æ˜¯ä½¿ç”¨é¸é …æ¨¡å¼ (éƒ¨åˆ†æ©Ÿå™¨ç¿»è­¯)ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±ä½¿ç”¨é¸é …æ¨¡å¼ç¹«çµéšå±¤å¼è¨­å®šè³‡æ–™ã€‚\né‡å°ç®¡ç†ä¿å¯†çµ„æ…‹è³‡æ–™ (ä¾‹å¦‚å¯†ç¢¼)ï¼Œ.NET Core æä¾›ç¥•å¯†ç®¡ç†å“¡ã€‚ é‡å°ç”Ÿç”¢ç¥•å¯†ï¼Œæˆ‘å€‘å»ºè­°ä½¿ç”¨ Azure Key Vaultã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„çµ„æ…‹ã€‚\nç’°å¢ƒ\nåŸ·è¡Œç’°å¢ƒ (ä¾‹å¦‚ Developmentã€Staging å’Œ Production) æ˜¯ ASP.NET Core ä¸­çš„ç¬¬ä¸€ç´šæ¦‚å¿µã€‚ é€éè¨­å®š ASPNETCORE_ENVIRONMENT ç’°å¢ƒè®Šæ•¸ä¾†æŒ‡å®šæ‡‰ç”¨ç¨‹å¼åŸ·è¡Œçš„ç’°å¢ƒã€‚ ASP.NET Core æœƒåœ¨æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•æ™‚è®€å–ç’°å¢ƒè®Šæ•¸ï¼Œç„¶å¾Œå°‡å€¼å„²å­˜åœ¨ IWebHostEnvironment å¯¦ä½œä¸­ã€‚ æ‚¨å¯åœ¨æ‡‰ç”¨ç¨‹å¼ä¸­é€éç›¸ä¾æ€§æ’å…¥ (DI) å–å¾—æ­¤å¯¦ä½œã€‚\nä¸‹åˆ—ç¯„ä¾‹æœƒå°‡æ‡‰ç”¨ç¨‹å¼è¨­å®šç‚ºåœ¨ Development ç’°å¢ƒä¸­åŸ·è¡Œæ™‚ï¼Œæä¾›è©³ç´°çš„éŒ¯èª¤è³‡è¨Šï¼š\npublic void Configure(IApplicationBuilder app, IWebHostEnvironment env)\n{\n    if (env.IsDevelopment())\n    {\n        app.UseDeveloperExceptionPage();\n    }\n    else\n    {\n        app.UseExceptionHandler(\"/Error\");\n        app.UseHsts();\n    }\n\n    app.UseHttpsRedirection();\n    app.UseStaticFiles();\n\n    app.UseRouting();\n\n    app.UseEndpoints(endpoints =>\n    {\n        endpoints.MapDefaultControllerRoute();\n        endpoints.MapRazorPages();\n    });\n}\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä½¿ç”¨å¤šå€‹ç’°å¢ƒ (éƒ¨åˆ†æ©Ÿå™¨ç¿»è­¯)ã€‚\nè¨˜éŒ„\nASP.NET Core æ”¯æ´è¨˜éŒ„ APIï¼Œæ­¤ API èƒ½èˆ‡å„ç¨®å…§å»ºå’Œç¬¬ä¸‰æ–¹è¨˜éŒ„æä¾›è€…æ­é…ä½¿ç”¨ã€‚ å¯ç”¨çš„æä¾›è€…åŒ…æ‹¬ï¼š\n\nä¸»æ§å°\nåµéŒ¯\nWindows ä¸Šçš„äº‹ä»¶è¿½è¹¤\nWindows äº‹ä»¶è¨˜éŒ„æª”\nTraceSource\nAzure App Service\nAzure Application Insights\n\nè‹¥è¦å»ºç«‹è¨˜éŒ„ï¼ŒILogger<TCategoryName>è«‹å¾ç›¸ä¾æ€§æ’å…¥ (DI) å’Œé€šè©±è¨˜éŒ„æ–¹æ³• (ä¾‹å¦‚ LogInformation) è§£ææœå‹™ã€‚ ä¾‹å¦‚ï¼š\npublic class TodoController : ControllerBase\n{\n    private readonly ILogger _logger;\n\n    public TodoController(ILogger<TodoController> logger)\n    {\n        _logger = logger;\n    }\n\n    [HttpGet(\"{id}\", Name = \"GetTodo\")]\n    public ActionResult<TodoItem> GetById(string id)\n    {\n        _logger.LogInformation(LoggingEvents.GetItem, \"Getting item {Id}\", id);\n        \n        // Item lookup code removed.\n        \n        if (item == null)\n        {\n            _logger.LogWarning(LoggingEvents.GetItemNotFound, \"GetById({Id}) NOT FOUND\", id);\n            return NotFound();\n        }\n        \n        return item;\n    }\n}\n\nè¨˜éŒ„æ–¹æ³• (ä¾‹å¦‚ LogInformation) æ”¯æ´ä»»ä½•æ•¸ç›®çš„æ¬„ä½ã€‚ é€™äº›æ¬„ä½é€šå¸¸ç”¨ä¾†å»ºæ§‹è¨Šæ¯ stringï¼Œä½†æœ‰äº›è¨˜éŒ„æä¾›è€…æœƒå°‡é€™äº›æ¬„ä½å‚³é€è‡³è³‡æ–™å­˜æ”¾å€åšç‚ºå€‹åˆ¥æ¬„ä½ã€‚ é€™é …åŠŸèƒ½å¯è®“è¨˜éŒ„æä¾›è€…å¯¦ä½œ semantic logging (èªæ„è¨˜éŒ„)ï¼Œåˆç¨±ç‚º structured logging (çµæ§‹åŒ–è¨˜éŒ„)ã€‚\nå¦‚éœ€è©³ç´°è³‡æ–™ï¼Œè«‹åƒé–± .NET Core èˆ‡ ASP.NET Core ä¸­çš„è¨˜éŒ„ã€‚\nè·¯ç”±\nã€Œè·¯ç”±ã€æ˜¯ä¸€ç¨®å°æ‡‰åˆ°è™•ç†å¸¸å¼çš„ URL æ¨¡å¼ã€‚ è™•ç†å¸¸å¼é€šå¸¸æ˜¯ Razor é é¢ã€MVC æ§åˆ¶å™¨ä¸­çš„å‹•ä½œæ–¹æ³•ï¼Œæˆ–æ˜¯ä¸­ä»‹è»Ÿé«”ã€‚ ASP.NET Core è·¯ç”±å¯è®“æ‚¨æ§åˆ¶æ‚¨æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨çš„ URLã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„è·¯ç·šè¦åŠƒã€‚\néŒ¯èª¤è™•ç†\nASP.NET Core å…·æœ‰è™•ç†éŒ¯èª¤çš„å…§å»ºåŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š\n\né–‹ç™¼äººå“¡ä¾‹å¤–ç‹€æ³é é¢\nè‡ªè¨‚éŒ¯èª¤é é¢\néœæ…‹ç‹€æ…‹ç¢¼é é¢\nå•Ÿå‹•ä¾‹å¤–ç‹€æ³è™•ç†\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±è™•ç† ASP.NET Core ä¸­çš„éŒ¯èª¤ã€‚\nç™¼å‡º HTTP è¦æ±‚\n\n              IHttpClientFactory çš„å¯¦ä½œå¯ç”¨æ–¼å»ºç«‹ HttpClient åŸ·è¡Œå€‹é«”ã€‚ Factoryï¼š\n\næä¾›ä¸€å€‹é›†ä¸­ä½ç½®ä»¥ä¾¿å‘½åå’Œè¨­å®šé‚è¼¯ HttpClient åŸ·è¡Œå€‹é«”ã€‚ ä¾‹å¦‚ï¼Œè¨»å†Šä¸¦è¨­å®š Github ç”¨æˆ¶ç«¯ä»¥å­˜å– GitHubã€‚ è¨»å†Šä¸¦è¨­å®šé è¨­ç”¨æˆ¶ç«¯ä»¥ä¾›å…¶ä»–ç”¨é€”ä½¿ç”¨ã€‚\næ”¯æ´è¨»å†ŠåŠå¤šå€‹å§”æ´¾è™•ç†å¸¸å¼çš„éˆçµï¼Œä»¥ç”¨æ–¼å»ºç½®å‚³å‡ºè¦æ±‚ä¸­ä»‹è»Ÿé«”ç®¡ç·šã€‚ æ­¤æ¨¡å¼èˆ‡ ASP.NET Core çš„è¼¸å…¥ä¸­ä»‹è»Ÿé«”ç®¡ç·šç›¸ä¼¼ã€‚ æ¨¡å¼æä¾›ä¸€å€‹æ©Ÿåˆ¶ä¾†ç®¡ç† HTTP è¦æ±‚çš„è·¨é ˜åŸŸé—œæ³¨ï¼ŒåŒ…æ‹¬å¿«å–ã€éŒ¯èª¤è™•ç†ã€åºåˆ—åŒ–å’Œè¨˜éŒ„ã€‚\nèˆ‡ Polly æ•´åˆï¼ŒPolly æ˜¯ä¸€ç¨®ç†±é–€çš„å”åŠ›å» å•†ç¨‹å¼åº«ï¼Œç”¨æ–¼é€²è¡Œæš«æ™‚æ€§çš„éŒ¯èª¤è™•ç†ã€‚\nç®¡ç†åŸºç¤ HttpClientHandler åŸ·è¡Œå€‹é«”çš„å…±ç”¨å’Œå­˜ç•™æœŸï¼Œä»¥é¿å…åœ¨æ‰‹å‹•ç®¡ç† HttpClient å­˜ç•™æœŸæ™‚ï¼Œç™¼ç”Ÿçš„å¸¸è¦‹ DNS å•é¡Œã€‚\né‡å°é€éè™•ç†ç«™æ‰€å»ºç«‹ä¹‹ç”¨æˆ¶ç«¯å‚³é€çš„æ‰€æœ‰è¦æ±‚ï¼Œæ–°å¢å¯è¨­å®šçš„è¨˜éŒ„é«”é©— (é€é ILogger)ã€‚\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä½¿ç”¨ IHttpClientFactory ç™¼å‡º HTTP è¦æ±‚ã€‚\nå…§å®¹æ ¹ç›®éŒ„\nå…§å®¹æ ¹ç›®éŒ„æ˜¯ä¸‹åˆ—é …ç›®çš„åŸºåº•è·¯å¾‘ï¼š\n\nè£è¼‰æ‡‰ç”¨ç¨‹å¼çš„å¯åŸ·è¡Œæª” (.exe)ã€‚\næ§‹æˆæ‡‰ç”¨ç¨‹å¼ (.dll) çš„å·²ç·¨è­¯çµ„ä»¶ã€‚\næ‡‰ç”¨ç¨‹å¼ä½¿ç”¨çš„å…§å®¹æª”æ¡ˆï¼Œä¾‹å¦‚ï¼š\n\n              Razor æª”æ¡ˆ (.cshtmlã€.razor)\nçµ„æ…‹æª” (.jsonã€.xml)\nè³‡æ–™æª”æ¡ˆ (.db)\n\n\n\n              Web æ ¹ç›®éŒ„ï¼Œé€šå¸¸æ˜¯ wwwroot è³‡æ–™å¤¾ã€‚\n\nåœ¨é–‹ç™¼æœŸé–“ï¼Œå…§å®¹æ ¹ç›®éŒ„é è¨­ç‚ºå°ˆæ¡ˆçš„æ ¹ç›®éŒ„ã€‚ æ­¤ç›®éŒ„ä¹Ÿæ˜¯æ‡‰ç”¨ç¨‹å¼å…§å®¹æª”æ¡ˆå’Œ Web æ ¹ç›®éŒ„çš„åŸºåº•è·¯å¾‘ã€‚ æŒ‡å®šä¸åŒçš„å…§å®¹æ ¹ç›®éŒ„ï¼Œæ–¹æ³•æ˜¯åœ¨å»ºç½®ä¸»æ©Ÿæ™‚è¨­å®šå…¶è·¯å¾‘ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±å…§å®¹æ ¹ã€‚\nWeb æ ¹ç›®éŒ„\nWeb æ ¹ç›®éŒ„æ˜¯å…¬ç”¨éœæ…‹è³‡æºæª”çš„åŸºåº•è·¯å¾‘ï¼Œä¾‹å¦‚ï¼š\n\næ¨£å¼è¡¨å–® (.css)\nJavaScript (.js)\næ˜ åƒ (.pngã€.jpg)\n\næ ¹æ“šé è¨­ï¼Œéœæ…‹æª”æ¡ˆåªæœƒè™•ç†ä¾†è‡ª Web æ ¹ç›®éŒ„åŠå…¶å­ç›®éŒ„çš„æª”æ¡ˆã€‚ Web æ ¹è·¯å¾‘é è¨­ç‚º {content root}/wwwrootã€‚ æŒ‡å®šä¸åŒçš„ Web æ ¹ç›®éŒ„ï¼Œæ–¹æ³•æ˜¯åœ¨å»ºç½®ä¸»æ©Ÿæ™‚è¨­å®šå…¶è·¯å¾‘ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± Web æ ¹ç›®éŒ„ã€‚\né˜²æ­¢åœ¨ wwwroot ä¸­ä½¿ç”¨å°ˆæ¡ˆæª”ä¸­çš„>ä¾†ç™¼ä½ˆæª”æ¡ˆã€‚ ä¸‹åˆ—ç¯„ä¾‹æœƒé˜²æ­¢åœ¨ wwwroot/local åŠå…¶å­ç›®éŒ„ä¸­ç™¼ä½ˆå…§å®¹ï¼š\n<ItemGroup>\n  <Content Update=\"wwwroot\\local\\**\\*.*\" CopyToPublishDirectory=\"Never\" />\n</ItemGroup>\n\nåœ¨ Razor.cshtml æª”æ¡ˆä¸­ï¼Œtilde-slash (~/) æœƒæŒ‡å‘ Web æ ¹ç›®éŒ„ã€‚ é–‹é ­ç‚º ~/ çš„è·¯å¾‘ç¨±ç‚ºè™›æ“¬è·¯å¾‘ã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„éœæ…‹æª”æ¡ˆã€‚\n\n\næœ¬æ–‡æä¾›å»ºç½® ASP.NET Core æ‡‰ç”¨ç¨‹å¼çš„åŸºæœ¬æ¦‚å¿µæ¦‚è§€ï¼ŒåŒ…æ‹¬ç›¸ä¾æ€§æ’å…¥ (DI)ã€è¨­å®šã€ä¸­ä»‹è»Ÿé«”ç­‰ç­‰ã€‚\nå¦‚éœ€ Blazor åŸºç¤çŸ¥è­˜æŒ‡å¼• (å…¶æœƒæ–°å¢æˆ–å–ä»£æ­¤ç¯€é»ä¸­çš„æŒ‡å¼•)ï¼Œè«‹åƒé–± ASP.NET Core Blazor åŸºæœ¬æ¦‚å¿µã€‚\nProgram.cs\nä½¿ç”¨ Web ç¯„æœ¬å»ºç«‹çš„ ASP.NET Core æ‡‰ç”¨ç¨‹å¼åŒ…å« Program.cs æª”æ¡ˆä¸­çš„æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•ç¨‹å¼ç¢¼ã€‚ \n              Program.cs æª”æ¡ˆä½æ–¼ä¸‹åˆ—ä½ç½®ï¼š\n\nå·²è¨­å®šæ‡‰ç”¨ç¨‹å¼æ‰€éœ€çš„æœå‹™ã€‚\næ‡‰ç”¨ç¨‹å¼çš„è¦æ±‚è™•ç†ç®¡ç·šæ˜¯å®šç¾©ç‚ºä¸€ç³»åˆ—ä¸­ä»‹è»Ÿé«”å…ƒä»¶ã€‚\n\nä¸‹åˆ—æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•ç¨‹å¼ç¢¼æ”¯æ´ï¼š\n\n\n              \n              Razor Pages\n\n              MVC æ§åˆ¶å™¨èˆ‡æª¢è¦–\n\n              Web API èˆ‡æ§åˆ¶å™¨\n\n              æœ€å° web API\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\n\napp.UseAuthorization();\n\napp.MapGet(\"/hi\", () => \"Hello!\");\n\napp.MapDefaultControllerRoute();\napp.MapRazorPages();\n\napp.Run();\nç›¸ä¾æ€§æ’å…¥ (æœå‹™)\nASP.NET Core åŒ…å«ç›¸ä¾æ€§æ’å…¥ (DI)ï¼Œå¯è®“æ•´å€‹æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨æ‰€è¨­å®šæœå‹™ã€‚ åœ¨ä¸Šè¿°ç¨‹å¼ç¢¼ä¸­ï¼Œæœå‹™æœƒæ–°å¢è‡³å…·æœ‰ WebApplicationBuilder.Servicesã€builder.Services çš„ DI å®¹å™¨ã€‚ å…·ç¾åŒ– WebApplicationBuilder æ™‚ï¼Œæœƒæ–°å¢è¨±å¤šæ¶æ§‹æ‰€æä¾›çš„æœå‹™ã€‚ \n              builder æ˜¯ä¸‹åˆ—ç¨‹å¼ç¢¼ä¸­çš„ WebApplicationBuilderï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\nåœ¨ä¸Šè¿°åç™½é¡¯ç¤ºçš„ç¨‹å¼ç¢¼ä¸­ï¼Œbuilder å·²å°‡çµ„æ…‹ã€è¨˜éŒ„å’Œè¨±å¤šå…¶ä»–æœå‹™æ–°å¢è‡³ DI å®¹å™¨ã€‚\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒå°‡ Razor Pagesã€å…·æœ‰æª¢è¦–çš„ MVC æ§åˆ¶å™¨ï¼Œä»¥åŠè‡ªè¨‚çš„ DbContext æ–°å¢è‡³ DI å®¹å™¨ï¼š\nusing Microsoft.EntityFrameworkCore;\nusing RazorPagesMovie.Data;\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nbuilder.Services.AddDbContext<RazorPagesMovieContext>(options =>\n   options.UseSqlServer(builder.Configuration.GetConnectionString(\"RPMovieContext\")));\n\nvar app = builder.Build();\n\né€šå¸¸æœƒä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥å¾ DI è§£ææœå‹™ã€‚ DI æ¶æ§‹æœƒåœ¨åŸ·è¡Œéšæ®µæä¾›æ­¤æœå‹™çš„åŸ·è¡Œå€‹é«”ã€‚\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥ï¼Œå¾ DI è§£æè³‡æ–™åº«å…§å®¹å’Œè¨˜éŒ„å™¨ï¼š\npublic class IndexModel : PageModel\n{\n    private readonly RazorPagesMovieContext _context;\n    private readonly ILogger<IndexModel> _logger;\n\n    public IndexModel(RazorPagesMovieContext context, ILogger<IndexModel> logger)\n    {\n        _context = context;\n        _logger = logger;\n    }\n\n    public IList<Movie> Movie { get;set; }\n\n    public async Task OnGetAsync()\n    {\n        _logger.LogInformation(\"IndexModel OnGetAsync.\");\n        Movie = await _context.Movie.ToListAsync();\n    }\n}\nä¸­ä»‹è»Ÿé«”\nè¦æ±‚è™•ç†ç®¡ç·šç”±ä¸€ç³»åˆ—ä¸­ä»‹è»Ÿé«”å…ƒä»¶æ‰€çµ„æˆã€‚ æ¯å€‹å…ƒä»¶æœƒåœ¨ HttpContext ä¸ŠåŸ·è¡Œæ“ä½œï¼Œä¸¦å«ç”¨ç®¡ç·šä¸­ä¸‹ä¸€å€‹ä¸­ä»‹è»Ÿé«”æˆ–çµ‚æ­¢è¦æ±‚ã€‚\nä¾ç…§æ…£ä¾‹ï¼Œä¸­ä»‹è»Ÿé«”å…ƒä»¶æœƒé€éå«ç”¨ Use{Feature} å»¶ä¼¸æ¨¡çµ„æ–¹æ³•ä¾†æ–°å¢è‡³ç®¡ç·šã€‚ ä¸‹åˆ—ç¨‹å¼ç¢¼ä¸­æœƒå°‡æ–°å¢è‡³æ‡‰ç”¨ç¨‹å¼çš„ä¸­ä»‹è»Ÿé«”åç™½é¡¯ç¤ºï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\n\napp.UseAuthorization();\n\napp.MapGet(\"/hi\", () => \"Hello!\");\n\napp.MapDefaultControllerRoute();\napp.MapRazorPages();\n\napp.Run();\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­ä»‹è»Ÿé«”ã€‚\nHost\nåœ¨å•Ÿå‹•æ™‚ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼æœƒå»ºç½®ä¸€å€‹ã€Œä¸»æ©Ÿã€ã€‚ ä¸»æ©Ÿæœƒå°è£æ‰€æœ‰æ‡‰ç”¨ç¨‹å¼çš„è³‡æºï¼Œä¾‹å¦‚ï¼š\n\nHTTP ä¼ºæœå™¨å¯¦ä½œ\nä¸­ä»‹è»Ÿé«”å…ƒä»¶\nè¨˜éŒ„\nç›¸ä¾æ€§æ’å…¥ (æœå‹™)\nçµ„æ…‹\n\næœ‰ä¸‰å€‹ä¸åŒçš„ä¸»æ©Ÿèƒ½å¤ åŸ·è¡Œ ASP.NET Core æ‡‰ç”¨ç¨‹å¼ï¼š\n\n\n              ASP.NET Core WebApplicationï¼Œä¹Ÿç¨±ç‚ºæœ€å°ä¸»æ©Ÿ\nçµåˆ ASP.NET Core  çš„ ConfigureWebHostDefaults\n\n              ASP.NET Core WebHost\n\nå»ºè­°ä½¿ç”¨ ASP.NET Core WebApplication å’Œ WebApplicationBuilder é¡å‹ï¼Œä¸¦ç”¨æ–¼æ‰€æœ‰ ASP.NET Core ç¯„æœ¬ã€‚ \n              WebApplication çš„é‹ä½œæ–¹å¼èˆ‡ .NET æ³›å‹ä¸»æ©Ÿé¡ä¼¼ï¼Œä¸¦å…¬é–‹è¨±å¤šç›¸åŒçš„ä»‹é¢ï¼Œä½†éœ€è¦è¼ƒå°‘çš„å›å‘¼é€²è¡Œè¨­å®šã€‚ ASP.NET Core WebHost åƒ…é©ç”¨æ–¼å›æº¯ç›¸å®¹æ€§ã€‚\nä¸‹åˆ—ç¯„ä¾‹æœƒå…·ç¾åŒ– WebApplicationï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\n\n              WebApplicationBuilder.Build æ–¹æ³•æœƒä½¿ç”¨ä¸€çµ„é è¨­é¸é …ä¾†è¨­å®šä¸»æ©Ÿï¼Œä¾‹å¦‚ï¼š\n\nä½¿ç”¨ Kestrel åšç‚ºç¶²é ä¼ºæœå™¨ï¼Œä¸¦å•Ÿç”¨ IIS æ•´åˆã€‚\nå¾ ã€ç’°å¢ƒè®Šæ•¸ã€å‘½ä»¤åˆ—å¼•æ•¸åŠå…¶ä»–ä¾†æºè¼‰å…¥appsettings.jsonã€‚\nå°‡è¨˜éŒ„è¼¸å‡ºå‚³é€åˆ°ä¸»æ§å°åŠåµéŒ¯æä¾›è€…ã€‚\n\né Web æ¡ˆä¾‹\nä¸€èˆ¬ä¸»æ©Ÿå…è¨±å…¶ä»–é¡å‹çš„æ‡‰ç”¨ç¨‹å¼ï¼Œä½¿ç”¨äº¤å‰å‰ªè¼¯æ¶æ§‹å»¶ä¼¸æ¨¡çµ„ï¼Œä¾‹å¦‚è¨˜éŒ„ã€ç›¸ä¾æ€§æ’å…¥ (DI)ã€è¨­å®šèˆ‡æ‡‰ç”¨ç¨‹å¼å­˜ç•™æœŸç®¡ç†ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„ .NET æ³›å‹ä¸»æ©Ÿï¼Œä»¥åŠåœ¨ ASP.NET Core ä¸­ä½¿ç”¨è¨—ç®¡æœå‹™çš„èƒŒæ™¯å·¥ä½œã€‚\nä¼ºæœå™¨\nASP.NET Core æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨ HTTP ä¼ºæœå™¨å¯¦ä½œä¾†æ¥è½ HTTP è¦æ±‚ã€‚ ä¼ºæœå™¨æœƒæŠŠå‘æ‡‰ç”¨ç¨‹å¼ç™¼å‡ºçš„è¦æ±‚ä½œç‚ºä¸€çµ„è¦æ±‚åŠŸèƒ½ï¼Œåˆä½µæˆä¸€å€‹ HttpContextã€‚\n\n\n\n\n              Windows\n\n\n\n              macOS\n\n\n\n              Linux\n\n\n\n\nASP.NET Core éš¨é™„ä¸‹åˆ—ä¼ºæœå™¨å¯¦ä½œï¼š\n\n\n              Kestrel æ˜¯è·¨å¹³å°çš„ç¶²é ä¼ºæœå™¨ã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ IIS åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚\n\n              IIS HTTP ä¼ºæœå™¨å‰‡æ˜¯é©ç”¨æ–¼ä½¿ç”¨ IIS Windows çš„ä¼ºæœå™¨ã€‚ é€éæ­¤ä¼ºæœå™¨ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼åŠ IIS ä¾¿å¯ä»¥åœ¨ç›¸åŒè™•ç†åºä¸­åŸ·è¡Œã€‚\n\n              HTTP.sys å‰‡æ˜¯é©ç”¨æ–¼ä¸¦æœªæ­é… IIS ä½¿ç”¨ Windows çš„ä¼ºæœå™¨ã€‚\n\n\n\n\nASP.NET Core æä¾› Kestrel è·¨å¹³å°ä¼ºæœå™¨å¯¦ä½œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ Nginx æˆ– Apache åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚\n\n\n\nASP.NET Core æä¾› Kestrel è·¨å¹³å°ä¼ºæœå™¨å¯¦ä½œã€‚ åœ¨ ASP.NET Core 2.0 æˆ–æ›´æ–°ç‰ˆæœ¬ä¸­ï¼ŒKestrel å¯ä»¥åšç‚ºç›´æ¥å‘ç¶²éš›ç¶²è·¯å…¬é–‹çš„å…¬çœ¾ Edge Server åŸ·è¡Œã€‚ \n              Kestrel é€šå¸¸æœƒä½¿ç”¨ Nginx æˆ– Apache åœ¨åå‘ Proxy è¨­å®šä¸­åŸ·è¡Œã€‚\n\n\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­å¯¦ä½œç¶²é ä¼ºæœå™¨ã€‚\nçµ„æ…‹\nASP.NET Core æä¾›çµ„æ…‹æ¶æ§‹ï¼Œå¯å¾çµ„æ…‹æä¾›è€…çš„å·²æ’åºé›†åˆä¸­ï¼Œä»¥æˆå°åç¨±å’Œæ•¸å€¼çš„å½¢å¼å–å¾—è¨­å®šã€‚ æ‚¨å¯ä»¥ä½¿ç”¨å„ç¨®ä¾†æºçš„å…§å»ºçµ„æ…‹æä¾›è€…ï¼Œä¾‹å¦‚ .json æª”æ¡ˆã€.xml æª”æ¡ˆã€ç’°å¢ƒè®Šæ•¸åŠå‘½ä»¤åˆ—å¼•æ•¸ã€‚ æ’°å¯«è‡ªè¨‚çµ„æ…‹æä¾›è€…ä»¥æ”¯æ´å…¶ä»–ä¾†æºã€‚\næ ¹æ“šé è¨­ï¼ŒASP.NET Core æ‡‰ç”¨ç¨‹å¼æœƒè¨­å®šç‚ºå¾ appsettings.jsonã€ç’°å¢ƒè®Šæ•¸ã€å‘½ä»¤åˆ—ç­‰é€²è¡Œè®€å–ã€‚ è¼‰å…¥æ‡‰ç”¨ç¨‹å¼çš„çµ„æ…‹æ™‚ï¼Œä¾†è‡ªç’°å¢ƒè®Šæ•¸çš„å€¼æœƒè¦†å¯«ä¾†è‡ª appsettings.json çš„å€¼ã€‚\né‡å°ç®¡ç†ä¿å¯†çµ„æ…‹è³‡æ–™ (ä¾‹å¦‚å¯†ç¢¼)ï¼Œ.NET Core æä¾›ç¥•å¯†ç®¡ç†å“¡ã€‚ é‡å°ç”Ÿç”¢ç¥•å¯†ï¼Œæˆ‘å€‘å»ºè­°ä½¿ç”¨ Azure Key Vaultã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„çµ„æ…‹ã€‚\nç’°å¢ƒ\nASP.NET Core ä¸­æä¾›åŸ·è¡Œç’°å¢ƒï¼Œä¾‹å¦‚ Developmentã€Staging å’Œ Productionã€‚ é€éè¨­å®š ASPNETCORE_ENVIRONMENT ç’°å¢ƒè®Šæ•¸ä¾†æŒ‡å®šæ‡‰ç”¨ç¨‹å¼åŸ·è¡Œçš„ç’°å¢ƒã€‚ ASP.NET Core æœƒåœ¨æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•æ™‚è®€å–ç’°å¢ƒè®Šæ•¸ï¼Œç„¶å¾Œå°‡å€¼å„²å­˜åœ¨ IWebHostEnvironment å¯¦ä½œä¸­ã€‚ æ‚¨å¯åœ¨æ‡‰ç”¨ç¨‹å¼ä¸­é€éç›¸ä¾æ€§æ’å…¥ (DI) å–å¾—æ­¤å¯¦ä½œã€‚\nä¸‹åˆ—ç¯„ä¾‹æœƒåœ¨æœªæ–¼  ç’°å¢ƒä¸­åŸ·è¡Œæ™‚ï¼Œè¨­å®šä¾‹å¤–è™•ç†å¸¸å¼å’Œ Development ä¸­ä»‹è»Ÿé«”ï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\n// Add services to the container.\nbuilder.Services.AddRazorPages();\nbuilder.Services.AddControllersWithViews();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\n\napp.UseAuthorization();\n\napp.MapGet(\"/hi\", () => \"Hello!\");\n\napp.MapDefaultControllerRoute();\napp.MapRazorPages();\n\napp.Run();\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä½¿ç”¨å¤šå€‹ç’°å¢ƒ (éƒ¨åˆ†æ©Ÿå™¨ç¿»è­¯)ã€‚\nè¨˜éŒ„\nASP.NET Core æ”¯æ´è¨˜éŒ„ APIï¼Œæ­¤ API èƒ½èˆ‡å„ç¨®å…§å»ºå’Œç¬¬ä¸‰æ–¹è¨˜éŒ„æä¾›è€…æ­é…ä½¿ç”¨ã€‚ å¯ç”¨çš„æä¾›è€…åŒ…æ‹¬ï¼š\n\nä¸»æ§å°\nåµéŒ¯\nWindows ä¸Šçš„äº‹ä»¶è¿½è¹¤\nWindows äº‹ä»¶è¨˜éŒ„æª”\nTraceSource\nAzure App Service\nAzure Application Insights\n\nè‹¥è¦å»ºç«‹è¨˜éŒ„ï¼ŒILogger<TCategoryName>è«‹å¾ç›¸ä¾æ€§æ’å…¥ (DI) å’Œé€šè©±è¨˜éŒ„æ–¹æ³• (ä¾‹å¦‚ LogInformation) è§£ææœå‹™ã€‚ ä¾‹å¦‚ï¼š\npublic class IndexModel : PageModel\n{\n    private readonly RazorPagesMovieContext _context;\n    private readonly ILogger<IndexModel> _logger;\n\n    public IndexModel(RazorPagesMovieContext context, ILogger<IndexModel> logger)\n    {\n        _context = context;\n        _logger = logger;\n    }\n\n    public IList<Movie> Movie { get;set; }\n\n    public async Task OnGetAsync()\n    {\n        _logger.LogInformation(\"IndexModel OnGetAsync.\");\n        Movie = await _context.Movie.ToListAsync();\n    }\n}\n\nå¦‚éœ€è©³ç´°è³‡æ–™ï¼Œè«‹åƒé–± .NET Core èˆ‡ ASP.NET Core ä¸­çš„è¨˜éŒ„ã€‚\nè·¯ç”±\nã€Œè·¯ç”±ã€æ˜¯ä¸€ç¨®å°æ‡‰åˆ°è™•ç†å¸¸å¼çš„ URL æ¨¡å¼ã€‚ è™•ç†å¸¸å¼é€šå¸¸æ˜¯ Razor é é¢ã€MVC æ§åˆ¶å™¨ä¸­çš„å‹•ä½œæ–¹æ³•ï¼Œæˆ–æ˜¯ä¸­ä»‹è»Ÿé«”ã€‚ ASP.NET Core è·¯ç”±å¯è®“æ‚¨æ§åˆ¶æ‚¨æ‡‰ç”¨ç¨‹å¼ä½¿ç”¨çš„ URLã€‚\nASP.NET Core Web æ‡‰ç”¨ç¨‹å¼ç¯„æœ¬æ‰€ç”¢ç”Ÿçš„ä¸‹åˆ—ç¨‹å¼ç¢¼æœƒå‘¼å« UseRoutingï¼š\nvar builder = WebApplication.CreateBuilder(args);\n\nbuilder.Services.AddRazorPages();\n\nvar app = builder.Build();\n\n// Configure the HTTP request pipeline.\nif (!app.Environment.IsDevelopment())\n{\n    app.UseExceptionHandler(\"/Error\");\n    app.UseHsts();\n}\n\napp.UseHttpsRedirection();\napp.UseStaticFiles();\n\napp.UseRouting();\n\napp.UseAuthorization();\n\napp.MapRazorPages();\n\napp.Run();\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„è·¯ç·šè¦åŠƒã€‚\néŒ¯èª¤è™•ç†\nASP.NET Core å…·æœ‰è™•ç†éŒ¯èª¤çš„å…§å»ºåŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š\n\né–‹ç™¼äººå“¡ä¾‹å¤–ç‹€æ³é é¢\nè‡ªè¨‚éŒ¯èª¤é é¢\néœæ…‹ç‹€æ…‹ç¢¼é é¢\nå•Ÿå‹•ä¾‹å¤–ç‹€æ³è™•ç†\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±è™•ç† ASP.NET Core ä¸­çš„éŒ¯èª¤ã€‚\nç™¼å‡º HTTP è¦æ±‚\n\n              IHttpClientFactory çš„å¯¦ä½œå¯ç”¨æ–¼å»ºç«‹ HttpClient åŸ·è¡Œå€‹é«”ã€‚ Factoryï¼š\n\næä¾›ä¸€å€‹é›†ä¸­ä½ç½®ä»¥ä¾¿å‘½åå’Œè¨­å®šé‚è¼¯ HttpClient åŸ·è¡Œå€‹é«”ã€‚ ä¾‹å¦‚ï¼Œè¨»å†Šä¸¦è¨­å®š Github ç”¨æˆ¶ç«¯ä»¥å­˜å– GitHubã€‚ è¨»å†Šä¸¦è¨­å®šé è¨­ç”¨æˆ¶ç«¯ä»¥ä¾›å…¶ä»–ç”¨é€”ä½¿ç”¨ã€‚\næ”¯æ´è¨»å†ŠåŠå¤šå€‹å§”æ´¾è™•ç†å¸¸å¼çš„éˆçµï¼Œä»¥ç”¨æ–¼å»ºç½®å‚³å‡ºè¦æ±‚ä¸­ä»‹è»Ÿé«”ç®¡ç·šã€‚ æ­¤æ¨¡å¼èˆ‡ ASP.NET Core çš„è¼¸å…¥ä¸­ä»‹è»Ÿé«”ç®¡ç·šç›¸ä¼¼ã€‚ æ¨¡å¼æä¾›ä¸€å€‹æ©Ÿåˆ¶ä¾†ç®¡ç† HTTP è¦æ±‚çš„è·¨é ˜åŸŸé—œæ³¨ï¼ŒåŒ…æ‹¬å¿«å–ã€éŒ¯èª¤è™•ç†ã€åºåˆ—åŒ–å’Œè¨˜éŒ„ã€‚\nèˆ‡ Polly æ•´åˆï¼ŒPolly æ˜¯ä¸€ç¨®ç†±é–€çš„å”åŠ›å» å•†ç¨‹å¼åº«ï¼Œç”¨æ–¼é€²è¡Œæš«æ™‚æ€§çš„éŒ¯èª¤è™•ç†ã€‚\nç®¡ç†åŸºç¤ HttpClientHandler åŸ·è¡Œå€‹é«”çš„å…±ç”¨å’Œå­˜ç•™æœŸï¼Œä»¥é¿å…åœ¨æ‰‹å‹•ç®¡ç† HttpClient å­˜ç•™æœŸæ™‚ï¼Œç™¼ç”Ÿçš„å¸¸è¦‹ DNS å•é¡Œã€‚\né‡å°é€éè™•ç†ç«™æ‰€å»ºç«‹ä¹‹ç”¨æˆ¶ç«¯å‚³é€çš„æ‰€æœ‰è¦æ±‚ï¼Œæ–°å¢å¯è¨­å®šçš„è¨˜éŒ„é«”é©— (é€é ILogger)ã€‚\n\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä½¿ç”¨ IHttpClientFactory ç™¼å‡º HTTP è¦æ±‚ã€‚\nå…§å®¹æ ¹ç›®éŒ„\nå…§å®¹æ ¹ç›®éŒ„æ˜¯ä¸‹åˆ—é …ç›®çš„åŸºåº•è·¯å¾‘ï¼š\n\nè£è¼‰æ‡‰ç”¨ç¨‹å¼çš„å¯åŸ·è¡Œæª” (.exe)ã€‚\næ§‹æˆæ‡‰ç”¨ç¨‹å¼ (.dll) çš„å·²ç·¨è­¯çµ„ä»¶ã€‚\næ‡‰ç”¨ç¨‹å¼ä½¿ç”¨çš„å…§å®¹æª”æ¡ˆï¼Œä¾‹å¦‚ï¼š\n\n              Razor æª”æ¡ˆ (.cshtmlã€.razor)\nçµ„æ…‹æª” (.jsonã€.xml)\nè³‡æ–™æª”æ¡ˆ (.db)\n\n\n\n              Web æ ¹ç›®éŒ„ï¼Œé€šå¸¸æ˜¯ wwwroot è³‡æ–™å¤¾ã€‚\n\nåœ¨é–‹ç™¼æœŸé–“ï¼Œå…§å®¹æ ¹ç›®éŒ„é è¨­ç‚ºå°ˆæ¡ˆçš„æ ¹ç›®éŒ„ã€‚ æ­¤ç›®éŒ„ä¹Ÿæ˜¯æ‡‰ç”¨ç¨‹å¼å…§å®¹æª”æ¡ˆå’Œ Web æ ¹ç›®éŒ„çš„åŸºåº•è·¯å¾‘ã€‚ æŒ‡å®šä¸åŒçš„å…§å®¹æ ¹ç›®éŒ„ï¼Œæ–¹æ³•æ˜¯åœ¨å»ºç½®ä¸»æ©Ÿæ™‚è¨­å®šå…¶è·¯å¾‘ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±å…§å®¹æ ¹ã€‚\nWeb æ ¹ç›®éŒ„\nWeb æ ¹ç›®éŒ„æ˜¯å…¬ç”¨éœæ…‹è³‡æºæª”çš„åŸºåº•è·¯å¾‘ï¼Œä¾‹å¦‚ï¼š\n\næ¨£å¼è¡¨å–® (.css)\nJavaScript (.js)\næ˜ åƒ (.pngã€.jpg)\n\næ ¹æ“šé è¨­ï¼Œéœæ…‹æª”æ¡ˆåªæœƒè™•ç†ä¾†è‡ª Web æ ¹ç›®éŒ„åŠå…¶å­ç›®éŒ„çš„æª”æ¡ˆã€‚ Web æ ¹è·¯å¾‘é è¨­ç‚º {content root}/wwwrootã€‚ æŒ‡å®šä¸åŒçš„ Web æ ¹ç›®éŒ„ï¼Œæ–¹æ³•æ˜¯åœ¨å»ºç½®ä¸»æ©Ÿæ™‚è¨­å®šå…¶è·¯å¾‘ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± Web æ ¹ç›®éŒ„ã€‚\né˜²æ­¢åœ¨ wwwroot ä¸­ä½¿ç”¨å°ˆæ¡ˆæª”ä¸­çš„>ä¾†ç™¼ä½ˆæª”æ¡ˆã€‚ ä¸‹åˆ—ç¯„ä¾‹æœƒé˜²æ­¢åœ¨ wwwroot/local åŠå…¶å­ç›®éŒ„ä¸­ç™¼ä½ˆå…§å®¹ï¼š\n<ItemGroup>\n  <Content Update=\"wwwroot\\local\\**\\*.*\" CopyToPublishDirectory=\"Never\" />\n</ItemGroup>\n\nåœ¨ Razor.cshtml æª”æ¡ˆä¸­ï¼Œ~/ æœƒæŒ‡å‘ Web æ ¹ç›®éŒ„ã€‚ é–‹é ­ç‚º ~/ çš„è·¯å¾‘ç¨±ç‚ºè™›æ“¬è·¯å¾‘ã€‚\nå¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± ASP.NET Core ä¸­çš„éœæ…‹æª”æ¡ˆã€‚\nå…¶ä»–è³‡æº\n\n\n              WebApplicationBuilder åŸå§‹ç¨‹å¼ç¢¼\n\n\n\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\n\n\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\tæ‚¨å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°æ­¤å…§å®¹çš„ä¾†æºï¼Œåœ¨å…¶ä¸­å»ºç«‹å’Œæª¢é–±å•é¡Œå’Œæå–è¦æ±‚ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±æˆ‘å€‘çš„åƒèˆ‡è€…æŒ‡å—ã€‚\n\t\t\t\t\n\t\t\t\n\n\t\t\t\t\t\t\n\t\n\n\t\n\n\t\n\n"
    },
    {
        "output": "URL: https://learn.microsoft.com/zh-tw/aspnet/core/fundamentals/middleware/extensibility-third-party-container\nTITLE: åœ¨ ASP.NET Core ä¸­ä»¥å”åŠ›å» å•†å®¹å™¨å•Ÿç”¨ä¸­ä»‹è»Ÿé«”\nCONTENT: \n\t\n\t\tè·³åˆ°ä¸»è¦å…§å®¹\n\n\t\t\n\t\t\t\tå·²ä¸å†æ”¯æ´æ­¤ç€è¦½å™¨ã€‚\n\t\t\t\tè«‹å‡ç´šè‡³ Microsoft Edgeï¼Œä»¥åˆ©ç”¨æœ€æ–°åŠŸèƒ½ã€å®‰å…¨æ€§æ›´æ–°å’ŒæŠ€è¡“æ”¯æ´ã€‚\n\t\t\t\t\n\t\t\t\n\t\t\n\n\t\t\n\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\n\t\n\n\t\n\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\tåœ¨ ASP.NET Core ä¸­ä»¥å”åŠ›å» å•†å®¹å™¨å•Ÿç”¨ä¸­ä»‹è»Ÿé«”\n\t\t\t\t\t\t\t\t\t\t\tç™¼è¡Œé …11/06/2024\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tæœ¬æ–‡å…§å®¹\n\t\t\t\t\t\t\t\t\t\t\næ³¨æ„\né€™ä¸æ˜¯é€™ç¯‡æ–‡ç« çš„æœ€æ–°ç‰ˆæœ¬ã€‚ å¦‚éœ€ç›®å‰çš„ç‰ˆæœ¬ï¼Œè«‹åƒé–± æœ¬æ–‡çš„ .NET 9 ç‰ˆæœ¬ã€‚\n\n\n\né‡è¦\né€™äº›ç™¼è¡Œå‰ç”¢å“çš„ç›¸é—œè³‡è¨Šåœ¨ç”¢å“æ­£å¼ç™¼è¡Œå‰å¯èƒ½æœƒæœ‰å¤§å¹…ä¿®æ”¹ã€‚ Microsoft å°æ­¤è™•æä¾›çš„è³‡è¨Šï¼Œä¸åšä»»ä½•æ˜ç¢ºæˆ–éš±å«çš„ç‘•ç–µæ“”ä¿ã€‚\nå¦‚éœ€ç›®å‰çš„ç‰ˆæœ¬ï¼Œè«‹åƒé–± æœ¬æ–‡çš„ .NET 9 ç‰ˆæœ¬ã€‚\n\n\n\næ­¤æ–‡ç« ç¤ºç¯„å¦‚ä½•ä½¿ç”¨ IMiddlewareFactory èˆ‡ IMiddleware ä½œç‚ºä»¥å”åŠ›å» å•†å®¹å™¨å•Ÿç”¨ä¸­ä»‹è»Ÿé«”çš„æ“´å……é»ã€‚ å¦‚éœ€ IMiddlewareFactory å’Œ IMiddleware çš„ç°¡ä»‹è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä»¥ Factory ç‚ºåŸºç¤çš„ä¸­ä»‹è»Ÿé«”å•Ÿç”¨ã€‚\næª¢è¦–æˆ–ä¸‹è¼‰ç¯„ä¾‹ç¨‹å¼ç¢¼ \\(è‹±æ–‡\\) (å¦‚ä½•ä¸‹è¼‰)\nç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼æœƒç¤ºç¯„å¦‚ä½•é€é IMiddlewareFactory çš„å¯¦ä½œ SimpleInjectorMiddlewareFactory ä¾†å•Ÿç”¨ä¸­ä»‹è»Ÿé«”ã€‚ æ­¤ç¯„ä¾‹æœƒä½¿ç”¨ Simple Injector ç›¸ä¾æ€§æ’å…¥ (DI) å®¹å™¨ã€‚\nç¯„ä¾‹çš„ä¸­ä»‹è»Ÿé«”å¯¦ä½œæœƒè¨˜éŒ„æŸ¥è©¢å­—ä¸²åƒæ•¸ (key) æ‰€æä¾›çš„å€¼ã€‚ ä¸­ä»‹è»Ÿé«”æœƒä½¿ç”¨æ’å…¥çš„è³‡æ–™åº«å…§å®¹ (ç¯„åœæœå‹™)ï¼Œä»¥è¨˜éŒ„è¨˜æ†¶é«”å…§éƒ¨è³‡æ–™åº«çš„æŸ¥è©¢å­—ä¸²å€¼ã€‚\n\nIMiddlewareFactory\nIMiddlewareFactory æä¾›å»ºç«‹ä¸­ä»‹è»Ÿé«”çš„æ–¹æ³•ã€‚\nåœ¨ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼ä¸­ï¼Œå°‡å¯¦ä½œä¸­ä»‹è»Ÿé«” Factory ä¾†å»ºç«‹ SimpleInjectorActivatedMiddleware åŸ·è¡Œå€‹é«”ã€‚ ä¸­ä»‹è»Ÿé«” Factory æœƒä½¿ç”¨ Simple Injector å®¹å™¨ä¾†è§£æä¸­ä»‹è»Ÿé«”ï¼š\npublic class SimpleInjectorMiddlewareFactory : IMiddlewareFactory\n{\n    private readonly Container _container;\n\n    public SimpleInjectorMiddlewareFactory(Container container)\n    {\n        _container = container;\n    }\n\n    public IMiddleware Create(Type middlewareType)\n    {\n        return _container.GetInstance(middlewareType) as IMiddleware;\n    }\n\n    public void Release(IMiddleware middleware)\n    {\n        // The container is responsible for releasing resources.\n    }\n}\nIMiddleware\nIMiddleware å¯å®šç¾©æ‡‰ç”¨ç¨‹å¼è¦æ±‚ç®¡ç·šçš„ä¸­ä»‹è»Ÿé«”ã€‚\nIMiddlewareFactory å¯¦ä½œæ‰€å•Ÿå‹•çš„ä¸­ä»‹è»Ÿé«” (Middleware/SimpleInjectorActivatedMiddleware.cs)ï¼š\npublic class SimpleInjectorActivatedMiddleware : IMiddleware\n{\n    private readonly AppDbContext _db;\n\n    public SimpleInjectorActivatedMiddleware(AppDbContext db)\n    {\n        _db = db;\n    }\n\n    public async Task InvokeAsync(HttpContext context, RequestDelegate next)\n    {\n        var keyValue = context.Request.Query[\"key\"];\n\n        if (!string.IsNullOrWhiteSpace(keyValue))\n        {\n            _db.Add(new Request()\n                {\n                    DT = DateTime.UtcNow, \n                    MiddlewareActivation = \"SimpleInjectorActivatedMiddleware\", \n                    Value = keyValue\n                });\n\n            await _db.SaveChangesAsync();\n        }\n\n        await next(context);\n    }\n}\n\nç‚ºä¸­ä»‹è»Ÿé«” (Middleware/MiddlewareExtensions.cs) å»ºç«‹å»¶ä¼¸æ¨¡çµ„ï¼š\npublic static class MiddlewareExtensions\n{\n    public static IApplicationBuilder UseSimpleInjectorActivatedMiddleware(\n        this IApplicationBuilder builder)\n    {\n        return builder.UseMiddleware<SimpleInjectorActivatedMiddleware>();\n    }\n}\n\nStartup.ConfigureServices å¿…é ˆåŸ·è¡Œå¹¾é …å·¥ä½œï¼š\n\nè¨­å®š Simple Injector å®¹å™¨ã€‚\nè¨»å†Š Factory å’Œä¸­ä»‹è»Ÿé«”ã€‚\nè®“æ‡‰ç”¨ç¨‹å¼çš„è³‡æ–™åº«å…§å®¹å¯å¾ Simple Injector å®¹å™¨ä½¿ç”¨ã€‚\n\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddRazorPages();\n\n    // Replace the default middleware factory with the \n    // SimpleInjectorMiddlewareFactory.\n    services.AddTransient<IMiddlewareFactory>(_ =>\n    {\n        return new SimpleInjectorMiddlewareFactory(_container);\n    });\n\n    // Wrap ASP.NET Core requests in a Simple Injector execution \n    // context.\n    services.UseSimpleInjectorAspNetRequestScoping(_container);\n\n    // Provide the database context from the Simple \n    // Injector container whenever it's requested from \n    // the default service container.\n    services.AddScoped<AppDbContext>(provider => \n        _container.GetInstance<AppDbContext>());\n\n    _container.Options.DefaultScopedLifestyle = new AsyncScopedLifestyle();\n\n    _container.Register<AppDbContext>(() => \n    {\n        var optionsBuilder = new DbContextOptionsBuilder<DbContext>();\n        optionsBuilder.UseInMemoryDatabase(\"InMemoryDb\");\n        return new AppDbContext(optionsBuilder.Options);\n    }, Lifestyle.Scoped);\n\n    _container.Register<SimpleInjectorActivatedMiddleware>();\n\n    _container.Verify();\n}\n\næ­¤ä¸­ä»‹è»Ÿé«”æœƒåœ¨è¦æ±‚è™•ç†ç®¡ç·šçš„ Startup.Configure ä¸­è¨»å†Šï¼š\npublic void Configure(IApplicationBuilder app, IWebHostEnvironment env)\n{\n    if (env.IsDevelopment())\n    {\n        app.UseDeveloperExceptionPage();\n    }\n    else\n    {\n        app.UseExceptionHandler(\"/Error\");\n    }\n\n    app.UseSimpleInjectorActivatedMiddleware();\n\n    app.UseStaticFiles();\n    app.UseRouting();\n\n    app.UseEndpoints(endpoints =>\n    {\n        endpoints.MapRazorPages();\n    });\n}\n\n\næ­¤æ–‡ç« ç¤ºç¯„å¦‚ä½•ä½¿ç”¨ IMiddlewareFactory èˆ‡ IMiddleware ä½œç‚ºä»¥å”åŠ›å» å•†å®¹å™¨å•Ÿç”¨ä¸­ä»‹è»Ÿé«”çš„æ“´å……é»ã€‚ å¦‚éœ€ IMiddlewareFactory å’Œ IMiddleware çš„ç°¡ä»‹è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä»¥ Factory ç‚ºåŸºç¤çš„ä¸­ä»‹è»Ÿé«”å•Ÿç”¨ã€‚\næª¢è¦–æˆ–ä¸‹è¼‰ç¯„ä¾‹ç¨‹å¼ç¢¼ \\(è‹±æ–‡\\) (å¦‚ä½•ä¸‹è¼‰)\nç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼æœƒç¤ºç¯„å¦‚ä½•é€é IMiddlewareFactory çš„å¯¦ä½œ SimpleInjectorMiddlewareFactory ä¾†å•Ÿç”¨ä¸­ä»‹è»Ÿé«”ã€‚ æ­¤ç¯„ä¾‹æœƒä½¿ç”¨ Simple Injector ç›¸ä¾æ€§æ’å…¥ (DI) å®¹å™¨ã€‚\nç¯„ä¾‹çš„ä¸­ä»‹è»Ÿé«”å¯¦ä½œæœƒè¨˜éŒ„æŸ¥è©¢å­—ä¸²åƒæ•¸ (key) æ‰€æä¾›çš„å€¼ã€‚ ä¸­ä»‹è»Ÿé«”æœƒä½¿ç”¨æ’å…¥çš„è³‡æ–™åº«å…§å®¹ (ç¯„åœæœå‹™)ï¼Œä»¥è¨˜éŒ„è¨˜æ†¶é«”å…§éƒ¨è³‡æ–™åº«çš„æŸ¥è©¢å­—ä¸²å€¼ã€‚\n\nIMiddlewareFactory\nIMiddlewareFactory æä¾›å»ºç«‹ä¸­ä»‹è»Ÿé«”çš„æ–¹æ³•ã€‚\nåœ¨ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼ä¸­ï¼Œå°‡å¯¦ä½œä¸­ä»‹è»Ÿé«” Factory ä¾†å»ºç«‹ SimpleInjectorActivatedMiddleware åŸ·è¡Œå€‹é«”ã€‚ ä¸­ä»‹è»Ÿé«” Factory æœƒä½¿ç”¨ Simple Injector å®¹å™¨ä¾†è§£æä¸­ä»‹è»Ÿé«”ï¼š\npublic class SimpleInjectorMiddlewareFactory : IMiddlewareFactory\n{\n    private readonly Container _container;\n\n    public SimpleInjectorMiddlewareFactory(Container container)\n    {\n        _container = container;\n    }\n\n    public IMiddleware Create(Type middlewareType)\n    {\n        return _container.GetInstance(middlewareType) as IMiddleware;\n    }\n\n    public void Release(IMiddleware middleware)\n    {\n        // The container is responsible for releasing resources.\n    }\n}\nIMiddleware\nIMiddleware å¯å®šç¾©æ‡‰ç”¨ç¨‹å¼è¦æ±‚ç®¡ç·šçš„ä¸­ä»‹è»Ÿé«”ã€‚\nIMiddlewareFactory å¯¦ä½œæ‰€å•Ÿå‹•çš„ä¸­ä»‹è»Ÿé«” (Middleware/SimpleInjectorActivatedMiddleware.cs)ï¼š\npublic class SimpleInjectorActivatedMiddleware : IMiddleware\n{\n    private readonly AppDbContext _db;\n\n    public SimpleInjectorActivatedMiddleware(AppDbContext db)\n    {\n        _db = db;\n    }\n\n    public async Task InvokeAsync(HttpContext context, RequestDelegate next)\n    {\n        var keyValue = context.Request.Query[\"key\"];\n\n        if (!string.IsNullOrWhiteSpace(keyValue))\n        {\n            _db.Add(new Request()\n                {\n                    DT = DateTime.UtcNow, \n                    MiddlewareActivation = \"SimpleInjectorActivatedMiddleware\", \n                    Value = keyValue\n                });\n\n            await _db.SaveChangesAsync();\n        }\n\n        await next(context);\n    }\n}\n\nç‚ºä¸­ä»‹è»Ÿé«” (Middleware/MiddlewareExtensions.cs) å»ºç«‹å»¶ä¼¸æ¨¡çµ„ï¼š\npublic static class MiddlewareExtensions\n{\n    public static IApplicationBuilder UseSimpleInjectorActivatedMiddleware(\n        this IApplicationBuilder builder)\n    {\n        return builder.UseMiddleware<SimpleInjectorActivatedMiddleware>();\n    }\n}\n\nStartup.ConfigureServices å¿…é ˆåŸ·è¡Œå¹¾é …å·¥ä½œï¼š\n\nè¨­å®š Simple Injector å®¹å™¨ã€‚\nè¨»å†Š Factory å’Œä¸­ä»‹è»Ÿé«”ã€‚\nè®“æ‡‰ç”¨ç¨‹å¼çš„è³‡æ–™åº«å…§å®¹å¯å¾ Simple Injector å®¹å™¨ä½¿ç”¨ã€‚\n\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n\n    // Replace the default middleware factory with the \n    // SimpleInjectorMiddlewareFactory.\n    services.AddTransient<IMiddlewareFactory>(_ =>\n    {\n        return new SimpleInjectorMiddlewareFactory(_container);\n    });\n\n    // Wrap ASP.NET Core requests in a Simple Injector execution \n    // context.\n    services.UseSimpleInjectorAspNetRequestScoping(_container);\n\n    // Provide the database context from the Simple \n    // Injector container whenever it's requested from \n    // the default service container.\n    services.AddScoped<AppDbContext>(provider => \n        _container.GetInstance<AppDbContext>());\n\n    _container.Options.DefaultScopedLifestyle = new AsyncScopedLifestyle();\n\n    _container.Register<AppDbContext>(() => \n    {\n        var optionsBuilder = new DbContextOptionsBuilder<DbContext>();\n        optionsBuilder.UseInMemoryDatabase(\"InMemoryDb\");\n        return new AppDbContext(optionsBuilder.Options);\n    }, Lifestyle.Scoped);\n\n    _container.Register<SimpleInjectorActivatedMiddleware>();\n\n    _container.Verify();\n}\n\næ­¤ä¸­ä»‹è»Ÿé«”æœƒåœ¨è¦æ±‚è™•ç†ç®¡ç·šçš„ Startup.Configure ä¸­è¨»å†Šï¼š\npublic void Configure(IApplicationBuilder app, IHostingEnvironment env)\n{\n    if (env.IsDevelopment())\n    {\n        app.UseDeveloperExceptionPage();\n    }\n    else\n    {\n        app.UseExceptionHandler(\"/Error\");\n    }\n\n    app.UseSimpleInjectorActivatedMiddleware();\n\n    app.UseStaticFiles();\n    app.UseMvc();\n}\n\nå…¶ä»–è³‡æº\n\nä¸­ä»‹è»Ÿé«”\nFactory å¼ä¸­ä»‹è»Ÿé«”å•Ÿç”¨\nSimple Injector GitHub repository (Simple Injector GitHub å­˜æ”¾åº«)\nSimple Injector documentation (Simple Injector æ–‡ä»¶)\n\n\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\n\n\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\tæ‚¨å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°æ­¤å…§å®¹çš„ä¾†æºï¼Œåœ¨å…¶ä¸­å»ºç«‹å’Œæª¢é–±å•é¡Œå’Œæå–è¦æ±‚ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±æˆ‘å€‘çš„åƒèˆ‡è€…æŒ‡å—ã€‚\n\t\t\t\t\n\t\t\t\n\n\t\t\t\t\t\t\n\t\n\n\t\n\n\t\n\n"
    },
    {
        "output": "URL: https://learn.microsoft.com/zh-tw/aspnet/core/mvc/controllers/dependency-injection\nTITLE: ASP.NET Core æ§åˆ¶å™¨çš„ç›¸ä¾æ€§æ’å…¥\nCONTENT: \n\t\n\t\tè·³åˆ°ä¸»è¦å…§å®¹\n\n\t\t\n\t\t\t\tå·²ä¸å†æ”¯æ´æ­¤ç€è¦½å™¨ã€‚\n\t\t\t\tè«‹å‡ç´šè‡³ Microsoft Edgeï¼Œä»¥åˆ©ç”¨æœ€æ–°åŠŸèƒ½ã€å®‰å…¨æ€§æ›´æ–°å’ŒæŠ€è¡“æ”¯æ´ã€‚\n\t\t\t\t\n\t\t\t\n\t\t\n\n\t\t\n\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\n\t\n\n\t\n\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\tASP.NET Core æ§åˆ¶å™¨çš„ç›¸ä¾æ€§æ’å…¥\n\t\t\t\t\t\t\t\t\t\t\tç™¼è¡Œé …11/06/2024\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tæœ¬æ–‡å…§å®¹\n\t\t\t\t\t\t\t\t\t\t\nä½œè€…ï¼šShadi Alnamrouti å’Œ Rick Anderson\n\nASP.NET Core MVC æ§åˆ¶å™¨æœƒé€éå»ºæ§‹å‡½å¼æ˜ç¢ºåœ°è¦æ±‚ç›¸ä¾æ€§ã€‚ ASP.NET Core å…§å»ºç›¸ä¾æ€§æ’å…¥ (DI) æ”¯æ´ã€‚ DI å¯è®“æ‚¨æ›´è¼•é¬†åœ°æ¸¬è©¦å’Œç¶­è­·æ‡‰ç”¨ç¨‹å¼ã€‚\næª¢è¦–æˆ–ä¸‹è¼‰ç¯„ä¾‹ç¨‹å¼ç¢¼ \\(è‹±æ–‡\\) (å¦‚ä½•ä¸‹è¼‰)\nå»ºæ§‹å‡½å¼æ’å…¥\næœå‹™æœƒæ–°å¢ä¾†ä½œç‚ºå»ºæ§‹å‡½å¼åƒæ•¸ï¼Œè€ŒåŸ·è¡Œéšæ®µæœƒè§£æä¾†è‡ªæœå‹™å®¹å™¨çš„æœå‹™ã€‚ é€šå¸¸å¯ä»¥ä½¿ç”¨ä»‹é¢ä¾†å®šç¾©æœå‹™ã€‚ ä¾‹å¦‚ï¼Œå‡è¨­æ‡‰ç”¨ç¨‹å¼éœ€è¦ç›®å‰çš„æ™‚é–“ã€‚ ä¸‹åˆ—ä»‹é¢æœƒå…¬é–‹ IDateTime æœå‹™ï¼š\npublic interface IDateTime\n{\n    DateTime Now { get; }\n}\n\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒå¯¦ä½œ IDateTime ä»‹é¢ï¼š\npublic class SystemDateTime : IDateTime\n{\n    public DateTime Now\n    {\n        get { return DateTime.Now; }\n    }\n}\n\nå°‡æœå‹™æ–°å¢è‡³æœå‹™å®¹å™¨ï¼š\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddSingleton<IDateTime, SystemDateTime>();\n\n    services.AddControllersWithViews();\n}\n\nå¦‚éœ€ AddSingleton çš„è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± DI æœå‹™å­˜ç•™æœŸã€‚\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒæ ¹æ“šæ™‚æ®µä¾†å‘ä½¿ç”¨è€…é¡¯ç¤ºå•å€™èªï¼š\npublic class HomeController : Controller\n{\n    private readonly IDateTime _dateTime;\n\n    public HomeController(IDateTime dateTime)\n    {\n        _dateTime = dateTime;\n    }\n\n    public IActionResult Index()\n    {\n        var serverTime = _dateTime.Now;\n        if (serverTime.Hour < 12)\n        {\n            ViewData[\"Message\"] = \"It's morning here - Good Morning!\";\n        }\n        else if (serverTime.Hour < 17)\n        {\n            ViewData[\"Message\"] = \"It's afternoon here - Good Afternoon!\";\n        }\n        else\n        {\n            ViewData[\"Message\"] = \"It's evening here - Good Evening!\";\n        }\n        return View();\n    }\n\nåŸ·è¡Œæ‡‰ç”¨ç¨‹å¼ï¼Œä¸¦æ ¹æ“šæ™‚é–“é¡¯ç¤ºè¨Šæ¯ã€‚\nä½¿ç”¨ FromServices é€²è¡Œå‹•ä½œæ’å…¥\nFromServicesAttribute èƒ½å¤ å°‡æœå‹™ç›´æ¥æ’å…¥è‡³å‹•ä½œæ–¹æ³•ï¼Œè€Œä¸éœ€ä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥ï¼š\npublic IActionResult About([FromServices] IDateTime dateTime)\n{\n    return Content( $\"Current server time: {dateTime.Now}\");\n}\nä½¿ç”¨ FromKeyedServices é€²è¡Œå‹•ä½œæ’å…¥\nä¸‹åˆ—ç¨‹å¼ç¢¼ç¤ºç¯„å¦‚ä½•ä½¿ç”¨ [FromKeyedServices] å±¬æ€§ä¾†å¾ DI å®¹å™¨å­˜å–å…·æœ‰ç´¢å¼•éµçš„æœå‹™ï¼š\nusing Microsoft.AspNetCore.Mvc;\n\nvar builder = WebApplication.CreateBuilder(args);\n\nbuilder.Services.AddKeyedSingleton<ICache, BigCache>(\"big\");\nbuilder.Services.AddKeyedSingleton<ICache, SmallCache>(\"small\");\nbuilder.Services.AddControllers();\n\nvar app = builder.Build();\n\napp.MapControllers();\n\napp.Run();\n\npublic interface ICache\n{\n    object Get(string key);\n}\npublic class BigCache : ICache\n{\n    public object Get(string key) => $\"Resolving {key} from big cache.\";\n}\n\npublic class SmallCache : ICache\n{\n    public object Get(string key) => $\"Resolving {key} from small cache.\";\n}\n\n[ApiController]\n[Route(\"/cache\")]\npublic class CustomServicesApiController : Controller\n{\n    [HttpGet(\"big\")]\n    public ActionResult<object> GetBigCache([FromKeyedServices(\"big\")] ICache cache)\n    {\n        return cache.Get(\"data-mvc\");\n    }\n\n    [HttpGet(\"small\")]\n    public ActionResult<object> GetSmallCache([FromKeyedServices(\"small\")] ICache cache)\n    {\n        return cache.Get(\"data-mvc\");\n    }\n}\n\nå¾æ§åˆ¶å™¨å­˜å–è¨­å®š\nå¾æ§åˆ¶å™¨å­˜å–æ‡‰ç”¨ç¨‹å¼æˆ–çµ„æ…‹è¨­å®šæ˜¯å¸¸è¦‹çš„æ¨¡å¼ã€‚ ASP.NET Core ä¸­çš„ [é¸é …] æ¨¡å¼ä¸­æ‰€è¿°çš„é¸é …æ¨¡å¼æ˜¯ç®¡ç†è¨­å®šçš„æ…£ç”¨æ–¹æ³•ã€‚ ä¸€èˆ¬è€Œè¨€ï¼Œä¸è¦å°‡ IConfiguration ç›´æ¥æ’å…¥è‡³æ§åˆ¶å™¨ã€‚\nå»ºç«‹è¦ä»£è¡¨é¸é …çš„é¡åˆ¥ã€‚ ä¾‹å¦‚ï¼š\npublic class SampleWebSettings\n{\n    public string Title { get; set; }\n    public int Updates { get; set; }\n}\n\nå°‡è¨­å®šé¡åˆ¥æ–°å¢è‡³æœå‹™é›†åˆï¼š\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddSingleton<IDateTime, SystemDateTime>();\n    services.Configure<SampleWebSettings>(Configuration);\n\n    services.AddControllersWithViews();\n}\n\nè¨­å®šæ‡‰ç”¨ç¨‹å¼ä»¥å¾ JSON æ ¼å¼çš„æª”æ¡ˆä¸­è®€å–è¨­å®šï¼š\npublic class Program\n{\n    public static void Main(string[] args)\n    {\n        CreateHostBuilder(args).Build().Run();\n    }\n\n    public static IHostBuilder CreateHostBuilder(string[] args) =>\n        Host.CreateDefaultBuilder(args)\n            .ConfigureAppConfiguration((hostingContext, config) =>\n            {\n                config.AddJsonFile(\"samplewebsettings.json\",\n                    optional: false,\n                    reloadOnChange: true);\n            })\n            .ConfigureWebHostDefaults(webBuilder =>\n            {\n                webBuilder.UseStartup<Startup>();\n            });\n}\n\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒå‘æœå‹™å®¹å™¨è¦æ±‚ IOptions<SampleWebSettings> è¨­å®šï¼Œä¸¦åœ¨ Index æ–¹æ³•ä¸­ä½¿ç”¨å®ƒå€‘ï¼š\npublic class SettingsController : Controller\n{\n    private readonly SampleWebSettings _settings;\n\n    public SettingsController(IOptions<SampleWebSettings> settingsOptions)\n    {\n        _settings = settingsOptions.Value;\n    }\n\n    public IActionResult Index()\n    {\n        ViewData[\"Title\"] = _settings.Title;\n        ViewData[\"Updates\"] = _settings.Updates;\n        return View();\n    }\n}\nå…¶ä»–è³‡æº\n\nè«‹åƒé–±æ¸¬è©¦ ASP.NET Core ä¸­çš„æ§åˆ¶å™¨é‚è¼¯ä»¥äº†è§£å¦‚ä½•é€éæ˜ç¢ºåœ°è¦æ±‚æ§åˆ¶å™¨ä¸­çš„ç›¸ä¾æ€§ï¼Œä»¥è®“ç¨‹å¼ç¢¼æ›´å®¹æ˜“æ¸¬è©¦ã€‚\nå…·æœ‰ç´¢å¼•éµçš„æœå‹™ç›¸ä¾æ€§æ’å…¥å®¹å™¨æ”¯æ´\nä½¿ç”¨å”åŠ›å» å•†å¯¦ä½œä¾†å–ä»£é è¨­çš„ç›¸ä¾æ€§æ’å…¥å®¹å™¨ã€‚\n\n\n\nä½œè€…ï¼šShadi Alnamroutiã€Rick Anderson å’Œ Steve Smith\nASP.NET Core MVC æ§åˆ¶å™¨æœƒé€éå»ºæ§‹å‡½å¼æ˜ç¢ºåœ°è¦æ±‚ç›¸ä¾æ€§ã€‚ ASP.NET Core å…§å»ºç›¸ä¾æ€§æ’å…¥ (DI) æ”¯æ´ã€‚ DI å¯è®“æ‚¨æ›´è¼•é¬†åœ°æ¸¬è©¦å’Œç¶­è­·æ‡‰ç”¨ç¨‹å¼ã€‚\næª¢è¦–æˆ–ä¸‹è¼‰ç¯„ä¾‹ç¨‹å¼ç¢¼ \\(è‹±æ–‡\\) (å¦‚ä½•ä¸‹è¼‰)\nå»ºæ§‹å‡½å¼æ’å…¥\næœå‹™æœƒæ–°å¢ä¾†ä½œç‚ºå»ºæ§‹å‡½å¼åƒæ•¸ï¼Œè€ŒåŸ·è¡Œéšæ®µæœƒè§£æä¾†è‡ªæœå‹™å®¹å™¨çš„æœå‹™ã€‚ é€šå¸¸å¯ä»¥ä½¿ç”¨ä»‹é¢ä¾†å®šç¾©æœå‹™ã€‚ ä¾‹å¦‚ï¼Œå‡è¨­æ‡‰ç”¨ç¨‹å¼éœ€è¦ç›®å‰çš„æ™‚é–“ã€‚ ä¸‹åˆ—ä»‹é¢æœƒå…¬é–‹ IDateTime æœå‹™ï¼š\npublic interface IDateTime\n{\n    DateTime Now { get; }\n}\n\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒå¯¦ä½œ IDateTime ä»‹é¢ï¼š\npublic class SystemDateTime : IDateTime\n{\n    public DateTime Now\n    {\n        get { return DateTime.Now; }\n    }\n}\n\nå°‡æœå‹™æ–°å¢è‡³æœå‹™å®¹å™¨ï¼š\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddSingleton<IDateTime, SystemDateTime>();\n\n    services.AddControllersWithViews();\n}\n\nå¦‚éœ€ AddSingleton çš„è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± DI æœå‹™å­˜ç•™æœŸã€‚\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒæ ¹æ“šæ™‚æ®µä¾†å‘ä½¿ç”¨è€…é¡¯ç¤ºå•å€™èªï¼š\npublic class HomeController : Controller\n{\n    private readonly IDateTime _dateTime;\n\n    public HomeController(IDateTime dateTime)\n    {\n        _dateTime = dateTime;\n    }\n\n    public IActionResult Index()\n    {\n        var serverTime = _dateTime.Now;\n        if (serverTime.Hour < 12)\n        {\n            ViewData[\"Message\"] = \"It's morning here - Good Morning!\";\n        }\n        else if (serverTime.Hour < 17)\n        {\n            ViewData[\"Message\"] = \"It's afternoon here - Good Afternoon!\";\n        }\n        else\n        {\n            ViewData[\"Message\"] = \"It's evening here - Good Evening!\";\n        }\n        return View();\n    }\n\nåŸ·è¡Œæ‡‰ç”¨ç¨‹å¼ï¼Œä¸¦æ ¹æ“šæ™‚é–“é¡¯ç¤ºè¨Šæ¯ã€‚\nä½¿ç”¨ FromServices é€²è¡Œå‹•ä½œæ’å…¥\nFromServicesAttribute èƒ½å¤ å°‡æœå‹™ç›´æ¥æ’å…¥è‡³å‹•ä½œæ–¹æ³•ï¼Œè€Œä¸éœ€ä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥ï¼š\npublic IActionResult About([FromServices] IDateTime dateTime)\n{\n    return Content( $\"Current server time: {dateTime.Now}\");\n}\nå¾æ§åˆ¶å™¨å­˜å–è¨­å®š\nå¾æ§åˆ¶å™¨å­˜å–æ‡‰ç”¨ç¨‹å¼æˆ–çµ„æ…‹è¨­å®šæ˜¯å¸¸è¦‹çš„æ¨¡å¼ã€‚ ASP.NET Core ä¸­çš„ [é¸é …] æ¨¡å¼ä¸­æ‰€è¿°çš„é¸é …æ¨¡å¼æ˜¯ç®¡ç†è¨­å®šçš„æ…£ç”¨æ–¹æ³•ã€‚ ä¸€èˆ¬è€Œè¨€ï¼Œä¸è¦å°‡ IConfiguration ç›´æ¥æ’å…¥è‡³æ§åˆ¶å™¨ã€‚\nå»ºç«‹è¦ä»£è¡¨é¸é …çš„é¡åˆ¥ã€‚ ä¾‹å¦‚ï¼š\npublic class SampleWebSettings\n{\n    public string Title { get; set; }\n    public int Updates { get; set; }\n}\n\nå°‡è¨­å®šé¡åˆ¥æ–°å¢è‡³æœå‹™é›†åˆï¼š\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddSingleton<IDateTime, SystemDateTime>();\n    services.Configure<SampleWebSettings>(Configuration);\n\n    services.AddControllersWithViews();\n}\n\nè¨­å®šæ‡‰ç”¨ç¨‹å¼ä»¥å¾ JSON æ ¼å¼çš„æª”æ¡ˆä¸­è®€å–è¨­å®šï¼š\npublic class Program\n{\n    public static void Main(string[] args)\n    {\n        CreateHostBuilder(args).Build().Run();\n    }\n\n    public static IHostBuilder CreateHostBuilder(string[] args) =>\n        Host.CreateDefaultBuilder(args)\n            .ConfigureAppConfiguration((hostingContext, config) =>\n            {\n                config.AddJsonFile(\"samplewebsettings.json\",\n                    optional: false,\n                    reloadOnChange: true);\n            })\n            .ConfigureWebHostDefaults(webBuilder =>\n            {\n                webBuilder.UseStartup<Startup>();\n            });\n}\n\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒå‘æœå‹™å®¹å™¨è¦æ±‚ IOptions<SampleWebSettings> è¨­å®šï¼Œä¸¦åœ¨ Index æ–¹æ³•ä¸­ä½¿ç”¨å®ƒå€‘ï¼š\npublic class SettingsController : Controller\n{\n    private readonly SampleWebSettings _settings;\n\n    public SettingsController(IOptions<SampleWebSettings> settingsOptions)\n    {\n        _settings = settingsOptions.Value;\n    }\n\n    public IActionResult Index()\n    {\n        ViewData[\"Title\"] = _settings.Title;\n        ViewData[\"Updates\"] = _settings.Updates;\n        return View();\n    }\n}\nå…¶ä»–è³‡æº\n\nè«‹åƒé–±æ¸¬è©¦ ASP.NET Core ä¸­çš„æ§åˆ¶å™¨é‚è¼¯ä»¥äº†è§£å¦‚ä½•é€éæ˜ç¢ºåœ°è¦æ±‚æ§åˆ¶å™¨ä¸­çš„ç›¸ä¾æ€§ï¼Œä»¥è®“ç¨‹å¼ç¢¼æ›´å®¹æ˜“æ¸¬è©¦ã€‚\n\nä½¿ç”¨å”åŠ›å» å•†å¯¦ä½œä¾†å–ä»£é è¨­çš„ç›¸ä¾æ€§æ’å…¥å®¹å™¨ã€‚\n\n\n\n\nä½œè€…ï¼šShadi Namroutiã€Rick Anderson å’Œ Steve Smith\nASP.NET Core MVC æ§åˆ¶å™¨æœƒé€éå»ºæ§‹å‡½å¼æ˜ç¢ºåœ°è¦æ±‚ç›¸ä¾æ€§ã€‚ ASP.NET Core å…§å»ºç›¸ä¾æ€§æ’å…¥ (DI) æ”¯æ´ã€‚ DI å¯è®“æ‚¨æ›´è¼•é¬†åœ°æ¸¬è©¦å’Œç¶­è­·æ‡‰ç”¨ç¨‹å¼ã€‚\næª¢è¦–æˆ–ä¸‹è¼‰ç¯„ä¾‹ç¨‹å¼ç¢¼ \\(è‹±æ–‡\\) (å¦‚ä½•ä¸‹è¼‰)\nå»ºæ§‹å‡½å¼æ’å…¥\næœå‹™æœƒæ–°å¢ä¾†ä½œç‚ºå»ºæ§‹å‡½å¼åƒæ•¸ï¼Œè€ŒåŸ·è¡Œéšæ®µæœƒè§£æä¾†è‡ªæœå‹™å®¹å™¨çš„æœå‹™ã€‚ é€šå¸¸å¯ä»¥ä½¿ç”¨ä»‹é¢ä¾†å®šç¾©æœå‹™ã€‚ ä¾‹å¦‚ï¼Œå‡è¨­æ‡‰ç”¨ç¨‹å¼éœ€è¦ç›®å‰çš„æ™‚é–“ã€‚ ä¸‹åˆ—ä»‹é¢æœƒå…¬é–‹ IDateTime æœå‹™ï¼š\npublic interface IDateTime\n{\n    DateTime Now { get; }\n}\n\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒå¯¦ä½œ IDateTime ä»‹é¢ï¼š\npublic class SystemDateTime : IDateTime\n{\n    public DateTime Now\n    {\n        get { return DateTime.Now; }\n    }\n}\n\nå°‡æœå‹™æ–°å¢è‡³æœå‹™å®¹å™¨ï¼š\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddSingleton<IDateTime, SystemDateTime>();\n\n    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n}\n\nå¦‚éœ€ AddSingleton çš„è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–± DI æœå‹™å­˜ç•™æœŸã€‚\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒæ ¹æ“šæ™‚æ®µä¾†å‘ä½¿ç”¨è€…é¡¯ç¤ºå•å€™èªï¼š\npublic class HomeController : Controller\n{\n    private readonly IDateTime _dateTime;\n\n    public HomeController(IDateTime dateTime)\n    {\n        _dateTime = dateTime;\n    }\n\n    public IActionResult Index()\n    {\n        var serverTime = _dateTime.Now;\n        if (serverTime.Hour < 12)\n        {\n            ViewData[\"Message\"] = \"It's morning here - Good Morning!\";\n        }\n        else if (serverTime.Hour < 17)\n        {\n            ViewData[\"Message\"] = \"It's afternoon here - Good Afternoon!\";\n        }\n        else\n        {\n            ViewData[\"Message\"] = \"It's evening here - Good Evening!\";\n        }\n        return View();\n    }\n\nåŸ·è¡Œæ‡‰ç”¨ç¨‹å¼ï¼Œä¸¦æ ¹æ“šæ™‚é–“é¡¯ç¤ºè¨Šæ¯ã€‚\nä½¿ç”¨ FromServices é€²è¡Œå‹•ä½œæ’å…¥\nFromServicesAttribute èƒ½å¤ å°‡æœå‹™ç›´æ¥æ’å…¥è‡³å‹•ä½œæ–¹æ³•ï¼Œè€Œä¸éœ€ä½¿ç”¨å»ºæ§‹å‡½å¼æ’å…¥ï¼š\npublic IActionResult About([FromServices] IDateTime dateTime)\n{\n    ViewData[\"Message\"] = $\"Current server time: {dateTime.Now}\";\n\n    return View();\n}\nå¾æ§åˆ¶å™¨å­˜å–è¨­å®š\nå¾æ§åˆ¶å™¨å­˜å–æ‡‰ç”¨ç¨‹å¼æˆ–çµ„æ…‹è¨­å®šæ˜¯å¸¸è¦‹çš„æ¨¡å¼ã€‚ ASP.NET Core ä¸­çš„ [é¸é …] æ¨¡å¼ä¸­æ‰€è¿°çš„é¸é …æ¨¡å¼æ˜¯ç®¡ç†è¨­å®šçš„æ…£ç”¨æ–¹æ³•ã€‚ ä¸€èˆ¬è€Œè¨€ï¼Œä¸è¦å°‡ IConfiguration ç›´æ¥æ’å…¥è‡³æ§åˆ¶å™¨ã€‚\nå»ºç«‹è¦ä»£è¡¨é¸é …çš„é¡åˆ¥ã€‚ ä¾‹å¦‚ï¼š\npublic class SampleWebSettings\n{\n    public string Title { get; set; }\n    public int Updates { get; set; }\n}\n\nå°‡è¨­å®šé¡åˆ¥æ–°å¢è‡³æœå‹™é›†åˆï¼š\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddSingleton<IDateTime, SystemDateTime>();\n    services.Configure<SampleWebSettings>(Configuration);\n    \n    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n}\n\nè¨­å®šæ‡‰ç”¨ç¨‹å¼ä»¥å¾ JSON æ ¼å¼çš„æª”æ¡ˆä¸­è®€å–è¨­å®šï¼š\npublic class Program\n{\n    public static void Main(string[] args)\n    {\n        CreateWebHostBuilder(args).Build().Run();\n    }\n\n    public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>\n        WebHost.CreateDefaultBuilder(args)\n        .ConfigureAppConfiguration((hostingContext, config) =>\n        {\n            config.AddJsonFile(\"samplewebsettings.json\", \n                                optional: false,        // File is not optional.\n                                reloadOnChange: false);\n        })\n        .UseStartup<Startup>();\n}\n\nä¸‹åˆ—ç¨‹å¼ç¢¼æœƒå‘æœå‹™å®¹å™¨è¦æ±‚ IOptions<SampleWebSettings> è¨­å®šï¼Œä¸¦åœ¨ Index æ–¹æ³•ä¸­ä½¿ç”¨å®ƒå€‘ï¼š\npublic class SettingsController : Controller\n{\n    private readonly SampleWebSettings _settings;\n\n    public SettingsController(IOptions<SampleWebSettings> settingsOptions)\n    {\n        _settings = settingsOptions.Value;\n    }\n\n    public IActionResult Index()\n    {\n        ViewData[\"Title\"] = _settings.Title;\n        ViewData[\"Updates\"] = _settings.Updates;\n        return View();\n    }\n}\nå…¶ä»–è³‡æº\n\nè«‹åƒé–±æ¸¬è©¦ ASP.NET Core ä¸­çš„æ§åˆ¶å™¨é‚è¼¯ä»¥äº†è§£å¦‚ä½•é€éæ˜ç¢ºåœ°è¦æ±‚æ§åˆ¶å™¨ä¸­çš„ç›¸ä¾æ€§ï¼Œä»¥è®“ç¨‹å¼ç¢¼æ›´å®¹æ˜“æ¸¬è©¦ã€‚\n\nä½¿ç”¨å”åŠ›å» å•†å¯¦ä½œä¾†å–ä»£é è¨­çš„ç›¸ä¾æ€§æ’å…¥å®¹å™¨ã€‚\n\n\n\n\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\n\n\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\tæ‚¨å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°æ­¤å…§å®¹çš„ä¾†æºï¼Œåœ¨å…¶ä¸­å»ºç«‹å’Œæª¢é–±å•é¡Œå’Œæå–è¦æ±‚ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±æˆ‘å€‘çš„åƒèˆ‡è€…æŒ‡å—ã€‚\n\t\t\t\t\n\t\t\t\n\n\t\t\t\t\t\t\n\t\n\n\t\n\n\t\n\n"
    },
    {
        "output": "URL: https://learn.microsoft.com/zh-tw/aspnet/core/fundamentals/middleware/extensibility-third-party-container\nTITLE: åœ¨ ASP.NET Core ä¸­ä»¥å”åŠ›å» å•†å®¹å™¨å•Ÿç”¨ä¸­ä»‹è»Ÿé«”\nCONTENT: \n\t\n\t\tè·³åˆ°ä¸»è¦å…§å®¹\n\n\t\t\n\t\t\t\tå·²ä¸å†æ”¯æ´æ­¤ç€è¦½å™¨ã€‚\n\t\t\t\tè«‹å‡ç´šè‡³ Microsoft Edgeï¼Œä»¥åˆ©ç”¨æœ€æ–°åŠŸèƒ½ã€å®‰å…¨æ€§æ›´æ–°å’ŒæŠ€è¡“æ”¯æ´ã€‚\n\t\t\t\t\n\t\t\t\n\t\t\n\n\t\t\n\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\n\t\n\n\t\n\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\tåœ¨ ASP.NET Core ä¸­ä»¥å”åŠ›å» å•†å®¹å™¨å•Ÿç”¨ä¸­ä»‹è»Ÿé«”\n\t\t\t\t\t\t\t\t\t\t\tç™¼è¡Œé …11/06/2024\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tæœ¬æ–‡å…§å®¹\n\t\t\t\t\t\t\t\t\t\t\næ³¨æ„\né€™ä¸æ˜¯é€™ç¯‡æ–‡ç« çš„æœ€æ–°ç‰ˆæœ¬ã€‚ å¦‚éœ€ç›®å‰çš„ç‰ˆæœ¬ï¼Œè«‹åƒé–± æœ¬æ–‡çš„ .NET 9 ç‰ˆæœ¬ã€‚\n\n\n\né‡è¦\né€™äº›ç™¼è¡Œå‰ç”¢å“çš„ç›¸é—œè³‡è¨Šåœ¨ç”¢å“æ­£å¼ç™¼è¡Œå‰å¯èƒ½æœƒæœ‰å¤§å¹…ä¿®æ”¹ã€‚ Microsoft å°æ­¤è™•æä¾›çš„è³‡è¨Šï¼Œä¸åšä»»ä½•æ˜ç¢ºæˆ–éš±å«çš„ç‘•ç–µæ“”ä¿ã€‚\nå¦‚éœ€ç›®å‰çš„ç‰ˆæœ¬ï¼Œè«‹åƒé–± æœ¬æ–‡çš„ .NET 9 ç‰ˆæœ¬ã€‚\n\n\n\næ­¤æ–‡ç« ç¤ºç¯„å¦‚ä½•ä½¿ç”¨ IMiddlewareFactory èˆ‡ IMiddleware ä½œç‚ºä»¥å”åŠ›å» å•†å®¹å™¨å•Ÿç”¨ä¸­ä»‹è»Ÿé«”çš„æ“´å……é»ã€‚ å¦‚éœ€ IMiddlewareFactory å’Œ IMiddleware çš„ç°¡ä»‹è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä»¥ Factory ç‚ºåŸºç¤çš„ä¸­ä»‹è»Ÿé«”å•Ÿç”¨ã€‚\næª¢è¦–æˆ–ä¸‹è¼‰ç¯„ä¾‹ç¨‹å¼ç¢¼ \\(è‹±æ–‡\\) (å¦‚ä½•ä¸‹è¼‰)\nç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼æœƒç¤ºç¯„å¦‚ä½•é€é IMiddlewareFactory çš„å¯¦ä½œ SimpleInjectorMiddlewareFactory ä¾†å•Ÿç”¨ä¸­ä»‹è»Ÿé«”ã€‚ æ­¤ç¯„ä¾‹æœƒä½¿ç”¨ Simple Injector ç›¸ä¾æ€§æ’å…¥ (DI) å®¹å™¨ã€‚\nç¯„ä¾‹çš„ä¸­ä»‹è»Ÿé«”å¯¦ä½œæœƒè¨˜éŒ„æŸ¥è©¢å­—ä¸²åƒæ•¸ (key) æ‰€æä¾›çš„å€¼ã€‚ ä¸­ä»‹è»Ÿé«”æœƒä½¿ç”¨æ’å…¥çš„è³‡æ–™åº«å…§å®¹ (ç¯„åœæœå‹™)ï¼Œä»¥è¨˜éŒ„è¨˜æ†¶é«”å…§éƒ¨è³‡æ–™åº«çš„æŸ¥è©¢å­—ä¸²å€¼ã€‚\n\nIMiddlewareFactory\nIMiddlewareFactory æä¾›å»ºç«‹ä¸­ä»‹è»Ÿé«”çš„æ–¹æ³•ã€‚\nåœ¨ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼ä¸­ï¼Œå°‡å¯¦ä½œä¸­ä»‹è»Ÿé«” Factory ä¾†å»ºç«‹ SimpleInjectorActivatedMiddleware åŸ·è¡Œå€‹é«”ã€‚ ä¸­ä»‹è»Ÿé«” Factory æœƒä½¿ç”¨ Simple Injector å®¹å™¨ä¾†è§£æä¸­ä»‹è»Ÿé«”ï¼š\npublic class SimpleInjectorMiddlewareFactory : IMiddlewareFactory\n{\n    private readonly Container _container;\n\n    public SimpleInjectorMiddlewareFactory(Container container)\n    {\n        _container = container;\n    }\n\n    public IMiddleware Create(Type middlewareType)\n    {\n        return _container.GetInstance(middlewareType) as IMiddleware;\n    }\n\n    public void Release(IMiddleware middleware)\n    {\n        // The container is responsible for releasing resources.\n    }\n}\nIMiddleware\nIMiddleware å¯å®šç¾©æ‡‰ç”¨ç¨‹å¼è¦æ±‚ç®¡ç·šçš„ä¸­ä»‹è»Ÿé«”ã€‚\nIMiddlewareFactory å¯¦ä½œæ‰€å•Ÿå‹•çš„ä¸­ä»‹è»Ÿé«” (Middleware/SimpleInjectorActivatedMiddleware.cs)ï¼š\npublic class SimpleInjectorActivatedMiddleware : IMiddleware\n{\n    private readonly AppDbContext _db;\n\n    public SimpleInjectorActivatedMiddleware(AppDbContext db)\n    {\n        _db = db;\n    }\n\n    public async Task InvokeAsync(HttpContext context, RequestDelegate next)\n    {\n        var keyValue = context.Request.Query[\"key\"];\n\n        if (!string.IsNullOrWhiteSpace(keyValue))\n        {\n            _db.Add(new Request()\n                {\n                    DT = DateTime.UtcNow, \n                    MiddlewareActivation = \"SimpleInjectorActivatedMiddleware\", \n                    Value = keyValue\n                });\n\n            await _db.SaveChangesAsync();\n        }\n\n        await next(context);\n    }\n}\n\nç‚ºä¸­ä»‹è»Ÿé«” (Middleware/MiddlewareExtensions.cs) å»ºç«‹å»¶ä¼¸æ¨¡çµ„ï¼š\npublic static class MiddlewareExtensions\n{\n    public static IApplicationBuilder UseSimpleInjectorActivatedMiddleware(\n        this IApplicationBuilder builder)\n    {\n        return builder.UseMiddleware<SimpleInjectorActivatedMiddleware>();\n    }\n}\n\nStartup.ConfigureServices å¿…é ˆåŸ·è¡Œå¹¾é …å·¥ä½œï¼š\n\nè¨­å®š Simple Injector å®¹å™¨ã€‚\nè¨»å†Š Factory å’Œä¸­ä»‹è»Ÿé«”ã€‚\nè®“æ‡‰ç”¨ç¨‹å¼çš„è³‡æ–™åº«å…§å®¹å¯å¾ Simple Injector å®¹å™¨ä½¿ç”¨ã€‚\n\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddRazorPages();\n\n    // Replace the default middleware factory with the \n    // SimpleInjectorMiddlewareFactory.\n    services.AddTransient<IMiddlewareFactory>(_ =>\n    {\n        return new SimpleInjectorMiddlewareFactory(_container);\n    });\n\n    // Wrap ASP.NET Core requests in a Simple Injector execution \n    // context.\n    services.UseSimpleInjectorAspNetRequestScoping(_container);\n\n    // Provide the database context from the Simple \n    // Injector container whenever it's requested from \n    // the default service container.\n    services.AddScoped<AppDbContext>(provider => \n        _container.GetInstance<AppDbContext>());\n\n    _container.Options.DefaultScopedLifestyle = new AsyncScopedLifestyle();\n\n    _container.Register<AppDbContext>(() => \n    {\n        var optionsBuilder = new DbContextOptionsBuilder<DbContext>();\n        optionsBuilder.UseInMemoryDatabase(\"InMemoryDb\");\n        return new AppDbContext(optionsBuilder.Options);\n    }, Lifestyle.Scoped);\n\n    _container.Register<SimpleInjectorActivatedMiddleware>();\n\n    _container.Verify();\n}\n\næ­¤ä¸­ä»‹è»Ÿé«”æœƒåœ¨è¦æ±‚è™•ç†ç®¡ç·šçš„ Startup.Configure ä¸­è¨»å†Šï¼š\npublic void Configure(IApplicationBuilder app, IWebHostEnvironment env)\n{\n    if (env.IsDevelopment())\n    {\n        app.UseDeveloperExceptionPage();\n    }\n    else\n    {\n        app.UseExceptionHandler(\"/Error\");\n    }\n\n    app.UseSimpleInjectorActivatedMiddleware();\n\n    app.UseStaticFiles();\n    app.UseRouting();\n\n    app.UseEndpoints(endpoints =>\n    {\n        endpoints.MapRazorPages();\n    });\n}\n\n\næ­¤æ–‡ç« ç¤ºç¯„å¦‚ä½•ä½¿ç”¨ IMiddlewareFactory èˆ‡ IMiddleware ä½œç‚ºä»¥å”åŠ›å» å•†å®¹å™¨å•Ÿç”¨ä¸­ä»‹è»Ÿé«”çš„æ“´å……é»ã€‚ å¦‚éœ€ IMiddlewareFactory å’Œ IMiddleware çš„ç°¡ä»‹è³‡è¨Šï¼Œè«‹åƒé–±åœ¨ ASP.NET Core ä¸­ä»¥ Factory ç‚ºåŸºç¤çš„ä¸­ä»‹è»Ÿé«”å•Ÿç”¨ã€‚\næª¢è¦–æˆ–ä¸‹è¼‰ç¯„ä¾‹ç¨‹å¼ç¢¼ \\(è‹±æ–‡\\) (å¦‚ä½•ä¸‹è¼‰)\nç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼æœƒç¤ºç¯„å¦‚ä½•é€é IMiddlewareFactory çš„å¯¦ä½œ SimpleInjectorMiddlewareFactory ä¾†å•Ÿç”¨ä¸­ä»‹è»Ÿé«”ã€‚ æ­¤ç¯„ä¾‹æœƒä½¿ç”¨ Simple Injector ç›¸ä¾æ€§æ’å…¥ (DI) å®¹å™¨ã€‚\nç¯„ä¾‹çš„ä¸­ä»‹è»Ÿé«”å¯¦ä½œæœƒè¨˜éŒ„æŸ¥è©¢å­—ä¸²åƒæ•¸ (key) æ‰€æä¾›çš„å€¼ã€‚ ä¸­ä»‹è»Ÿé«”æœƒä½¿ç”¨æ’å…¥çš„è³‡æ–™åº«å…§å®¹ (ç¯„åœæœå‹™)ï¼Œä»¥è¨˜éŒ„è¨˜æ†¶é«”å…§éƒ¨è³‡æ–™åº«çš„æŸ¥è©¢å­—ä¸²å€¼ã€‚\n\nIMiddlewareFactory\nIMiddlewareFactory æä¾›å»ºç«‹ä¸­ä»‹è»Ÿé«”çš„æ–¹æ³•ã€‚\nåœ¨ç¯„ä¾‹æ‡‰ç”¨ç¨‹å¼ä¸­ï¼Œå°‡å¯¦ä½œä¸­ä»‹è»Ÿé«” Factory ä¾†å»ºç«‹ SimpleInjectorActivatedMiddleware åŸ·è¡Œå€‹é«”ã€‚ ä¸­ä»‹è»Ÿé«” Factory æœƒä½¿ç”¨ Simple Injector å®¹å™¨ä¾†è§£æä¸­ä»‹è»Ÿé«”ï¼š\npublic class SimpleInjectorMiddlewareFactory : IMiddlewareFactory\n{\n    private readonly Container _container;\n\n    public SimpleInjectorMiddlewareFactory(Container container)\n    {\n        _container = container;\n    }\n\n    public IMiddleware Create(Type middlewareType)\n    {\n        return _container.GetInstance(middlewareType) as IMiddleware;\n    }\n\n    public void Release(IMiddleware middleware)\n    {\n        // The container is responsible for releasing resources.\n    }\n}\nIMiddleware\nIMiddleware å¯å®šç¾©æ‡‰ç”¨ç¨‹å¼è¦æ±‚ç®¡ç·šçš„ä¸­ä»‹è»Ÿé«”ã€‚\nIMiddlewareFactory å¯¦ä½œæ‰€å•Ÿå‹•çš„ä¸­ä»‹è»Ÿé«” (Middleware/SimpleInjectorActivatedMiddleware.cs)ï¼š\npublic class SimpleInjectorActivatedMiddleware : IMiddleware\n{\n    private readonly AppDbContext _db;\n\n    public SimpleInjectorActivatedMiddleware(AppDbContext db)\n    {\n        _db = db;\n    }\n\n    public async Task InvokeAsync(HttpContext context, RequestDelegate next)\n    {\n        var keyValue = context.Request.Query[\"key\"];\n\n        if (!string.IsNullOrWhiteSpace(keyValue))\n        {\n            _db.Add(new Request()\n                {\n                    DT = DateTime.UtcNow, \n                    MiddlewareActivation = \"SimpleInjectorActivatedMiddleware\", \n                    Value = keyValue\n                });\n\n            await _db.SaveChangesAsync();\n        }\n\n        await next(context);\n    }\n}\n\nç‚ºä¸­ä»‹è»Ÿé«” (Middleware/MiddlewareExtensions.cs) å»ºç«‹å»¶ä¼¸æ¨¡çµ„ï¼š\npublic static class MiddlewareExtensions\n{\n    public static IApplicationBuilder UseSimpleInjectorActivatedMiddleware(\n        this IApplicationBuilder builder)\n    {\n        return builder.UseMiddleware<SimpleInjectorActivatedMiddleware>();\n    }\n}\n\nStartup.ConfigureServices å¿…é ˆåŸ·è¡Œå¹¾é …å·¥ä½œï¼š\n\nè¨­å®š Simple Injector å®¹å™¨ã€‚\nè¨»å†Š Factory å’Œä¸­ä»‹è»Ÿé«”ã€‚\nè®“æ‡‰ç”¨ç¨‹å¼çš„è³‡æ–™åº«å…§å®¹å¯å¾ Simple Injector å®¹å™¨ä½¿ç”¨ã€‚\n\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n\n    // Replace the default middleware factory with the \n    // SimpleInjectorMiddlewareFactory.\n    services.AddTransient<IMiddlewareFactory>(_ =>\n    {\n        return new SimpleInjectorMiddlewareFactory(_container);\n    });\n\n    // Wrap ASP.NET Core requests in a Simple Injector execution \n    // context.\n    services.UseSimpleInjectorAspNetRequestScoping(_container);\n\n    // Provide the database context from the Simple \n    // Injector container whenever it's requested from \n    // the default service container.\n    services.AddScoped<AppDbContext>(provider => \n        _container.GetInstance<AppDbContext>());\n\n    _container.Options.DefaultScopedLifestyle = new AsyncScopedLifestyle();\n\n    _container.Register<AppDbContext>(() => \n    {\n        var optionsBuilder = new DbContextOptionsBuilder<DbContext>();\n        optionsBuilder.UseInMemoryDatabase(\"InMemoryDb\");\n        return new AppDbContext(optionsBuilder.Options);\n    }, Lifestyle.Scoped);\n\n    _container.Register<SimpleInjectorActivatedMiddleware>();\n\n    _container.Verify();\n}\n\næ­¤ä¸­ä»‹è»Ÿé«”æœƒåœ¨è¦æ±‚è™•ç†ç®¡ç·šçš„ Startup.Configure ä¸­è¨»å†Šï¼š\npublic void Configure(IApplicationBuilder app, IHostingEnvironment env)\n{\n    if (env.IsDevelopment())\n    {\n        app.UseDeveloperExceptionPage();\n    }\n    else\n    {\n        app.UseExceptionHandler(\"/Error\");\n    }\n\n    app.UseSimpleInjectorActivatedMiddleware();\n\n    app.UseStaticFiles();\n    app.UseMvc();\n}\n\nå…¶ä»–è³‡æº\n\nä¸­ä»‹è»Ÿé«”\nFactory å¼ä¸­ä»‹è»Ÿé«”å•Ÿç”¨\nSimple Injector GitHub repository (Simple Injector GitHub å­˜æ”¾åº«)\nSimple Injector documentation (Simple Injector æ–‡ä»¶)\n\n\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\n\n\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\tæ‚¨å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°æ­¤å…§å®¹çš„ä¾†æºï¼Œåœ¨å…¶ä¸­å»ºç«‹å’Œæª¢é–±å•é¡Œå’Œæå–è¦æ±‚ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±æˆ‘å€‘çš„åƒèˆ‡è€…æŒ‡å—ã€‚\n\t\t\t\t\n\t\t\t\n\n\t\t\t\t\t\t\n\t\n\n\t\n\n\t\n\n"
    },
    {
        "output": "URL: https://learn.microsoft.com/zh-tw/dotnet/core/dependency-loading/overview\nTITLE: ç›¸ä¾æ€§è¼‰å…¥ - .NET\nCONTENT: \n\t\n\t\tè·³åˆ°ä¸»è¦å…§å®¹\n\n\t\t\n\t\t\t\tå·²ä¸å†æ”¯æ´æ­¤ç€è¦½å™¨ã€‚\n\t\t\t\tè«‹å‡ç´šè‡³ Microsoft Edgeï¼Œä»¥åˆ©ç”¨æœ€æ–°åŠŸèƒ½ã€å®‰å…¨æ€§æ›´æ–°å’ŒæŠ€è¡“æ”¯æ´ã€‚\n\t\t\t\t\n\t\t\t\t\tä¸‹è¼‰ Microsoft Edge\n\t\t\t\t\tInternet Explorer å’Œ Microsoft Edge çš„è©³ç´°è³‡è¨Š\n\t\t\t\t\n\t\t\t\n\t\t\n\n\t\t\n\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\n\t\n\n\t\n\t\t\t\t\n\t\t\t\n\t\t\t\n\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\té–±è®€è‹±æ–‡\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\té–±è®€è‹±æ–‡\n\t\t\t\t\t\t\t\t\t\t\t\t\n\n\t\t\t \t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tå…±ç”¨æ–¹å¼ç‚º\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\t.NET ä¸­çš„ç›¸ä¾æ€§è¼‰å…¥\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tç™¼è¡Œé …02/26/2024\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\t\t\t\t\tæœ¬æ–‡å…§å®¹\n\t\t\t\t\t\t\t\t\t\tæ¯å€‹ .NET æ‡‰ç”¨ç¨‹å¼éƒ½æœ‰ç›¸ä¾æ€§ã€‚ å°±é€£å–®ç´”çš„ hello world æ‡‰ç”¨ç¨‹å¼ä¹Ÿå°éƒ¨åˆ† .NET é¡åˆ¥ç¨‹å¼åº«å…·æœ‰ç›¸ä¾æ€§ã€‚\näº†è§£ .NET ä¸­çš„é è¨­çµ„ä»¶è¼‰å…¥é‚è¼¯ï¼Œèƒ½å¹«åŠ©æ‚¨ç‚ºä¸€èˆ¬éƒ¨ç½²å•é¡Œç–‘é›£æ’è§£ã€‚\nåœ¨éƒ¨åˆ†æ‡‰ç”¨ç¨‹å¼ä¸­ï¼Œç›¸ä¾æ€§æœƒæ–¼åŸ·è¡Œéšæ®µå‹•æ…‹åˆ¤å®šã€‚ åœ¨é€™äº›æƒ…æ³ä¸­ï¼Œäº†è§£å—æ§çµ„ä»¶èˆ‡éå—æ§ç›¸ä¾æ€§çš„è¼‰å…¥æ–¹å¼å¾ˆé‡è¦ã€‚\nAssemblyLoadContext\nAssemblyLoadContext API æ˜¯ .NET è¼‰å…¥è¨­è¨ˆçš„æ ¸å¿ƒã€‚ äº†è§£ AssemblyLoadContext ä¸€æ–‡æä¾›è©²é …è¨­è¨ˆæ¦‚å¿µæ–¹é¢çš„æ¦‚è§€ã€‚\nè¼‰å…¥è©³ç´°è³‡æ–™\nè¼‰å…¥æ¼”ç®—æ³•çš„è©³ç´°è³‡æ–™ï¼Œç•¥è¿°æ–¼å¹¾ç¯‡æ–‡ç« ä¸­ï¼š\n\nå—æ§çµ„ä»¶è¼‰å…¥æ¼”ç®—æ³•\né™„å±¬çµ„ä»¶è¼‰å…¥æ¼”ç®—æ³•\néå—æ§ (åŸç”Ÿ) ç¨‹å¼åº«è¼‰å…¥æ¼”ç®—æ³•\né è¨­æ¢æŸ¥\n\nä½¿ç”¨å¤–æ›ç¨‹å¼å»ºç«‹æ‡‰ç”¨ç¨‹å¼\nç”¨å¤–æ›ç¨‹å¼å»ºç«‹ .NET æ‡‰ç”¨ç¨‹å¼ æ•™å­¸èª²ç¨‹èªªæ˜å¦‚ä½•å»ºç«‹è‡ªè¨‚ AssemblyLoadContextã€‚ å…¶ä¸­ä½¿ç”¨ AssemblyDependencyResolver ä¾†è§£æå¤–æ›ç¨‹å¼ä¸­çš„ç›¸ä¾æ€§ã€‚ è©²æ•™å­¸èª²ç¨‹æ­£ç¢ºåœ°å°‡å¤–æ›ç¨‹å¼çš„ç›¸ä¾æ€§å¾è£è¼‰æ‡‰ç”¨ç¨‹å¼ä¸­éš”é›¢å‡ºä¾†ã€‚\nçµ„ä»¶å¸è¼‰åŠŸèƒ½\nå¦‚ä½•åœ¨ .NET ä¸­ä½¿ç”¨ä¸¦åµéŒ¯çµ„ä»¶å¸è¼‰åŠŸèƒ½ä¸€æ–‡ç‚ºé€æ­¥æ•™å­¸èª²ç¨‹ã€‚ å…¶ä¸­ç¤ºç¯„å¦‚ä½•è¼‰å…¥ .NET æ‡‰ç”¨ç¨‹å¼ï¼Œç„¶å¾ŒåŸ·è¡Œä¸¦å¸è¼‰ä¹‹ã€‚ è©²ç¯‡æ–‡ç« ä¹Ÿæä¾›åµéŒ¯ç¥•è¨£ã€‚\næ”¶é›†è©³ç›¡çš„çµ„ä»¶è¼‰å…¥è³‡è¨Š\næ”¶é›†è©³ç›¡çš„çµ„ä»¶è¼‰å…¥è³‡è¨Š ä¸€æ–‡èªªæ˜å¦‚ä½•åœ¨åŸ·è¡Œéšæ®µæ”¶é›†å—æ§çµ„ä»¶è¼‰å…¥çš„è©³ç›¡è³‡è¨Šã€‚ å…¶ä¸­ä½¿ç”¨ dotnet-trace å·¥å…·ä¾†æ“·å–åŸ·è¡Œæµç¨‹è¿½è¹¤ä¸­çš„çµ„ä»¶è¼‰å…¥å™¨äº‹ä»¶ã€‚\n\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\n\n\t\t\t\t\t\t\n\t\t\n\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tåœ¨ GitHub ä¸Šèˆ‡æˆ‘å€‘å…±åŒä½œæ¥­\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\tæ‚¨å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°æ­¤å…§å®¹çš„ä¾†æºï¼Œåœ¨å…¶ä¸­å»ºç«‹å’Œæª¢é–±å•é¡Œå’Œæå–è¦æ±‚ã€‚ å¦‚éœ€è©³ç´°è³‡è¨Šï¼Œè«‹åƒé–±æˆ‘å€‘çš„åƒèˆ‡è€…æŒ‡å—ã€‚\n\t\t\t\t\n\t\t\t\n\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t.NET\n\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\té–‹å•Ÿæ–‡ä»¶å•é¡Œ\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tæä¾›ç”¢å“æ„è¦‹åæ‡‰\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\n\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tå…¶ä»–è³‡æº\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tæœ¬æ–‡å…§å®¹\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\n\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\n\t\n\n\t\n\n\t\n\n"
    }
    ]
---

system:
### Role Description:

You are a C# software development partner, specializing in assisting professional developers with any questions, suggestions, or clarifications related to C#. Your interaction style is relaxed and friendly, like chatting between developer friends. Keep responses concise and direct, providing explanations only when requested.

### Interaction Structure:

1. **Greet and Connect:** Start with a friendly greeting to set a relaxed atmosphere.
2. **Prompt Specific Query:** Ask for specific details about the C# issue or topic they need help with.
3. **Provide Direct Assistance:** Respond concisely to queries; avoid lengthy explanations unless specifically asked.
4. **Offer Further Help:** After providing assistance, ask if there's anything else related to C# they need help with.
5. **End Interaction:** Conclude the conversation with a friendly closing remark, encouraging them to reach out anytime they need further assistance.
6. **Language**: Respond in the same language as the user. BUT when the user uses ä¸­æ–‡: (Respond in æ­£é«”ä¸­æ–‡zh-tw not ç°¡é«”ä¸­æ–‡zh-cn. Use full-width punctuation marks and always add a space between Chinese characters and alphanumeric characters. å°ˆæœ‰åè©ä½¿ç”¨å°ç£æ­£é«”ä¸­æ–‡å¸¸ç”¨è¡“èªã€‚) Default to English if unclear. 

### AI Operation Guide:

- **Quick Response:** Aim for quick and straightforward answers to mimic real-time chat between friends.
- **Casual Language Use:** Maintain an informal and approachable tone throughout the interaction.
- **Provide Reference Links:** Always provide users with reference links when using Reference knowledge. Note: The link must genuinely exist in the referenced material; do not fabricate a link.
- **Wait for Prompting:** Do not elaborate on topics unless users request more detailed information.
- **Feedback Mechanism**: Encourage users to provide feedback on the solutions or information provided.

### Sample Prompt:

Hey! What C# challenge are you tackling today? 

### Additional Prompt:

Got it! Need help with anything else related to C#? Or do you have something else on your mind?

### Closing Prompt:

Great! If you need more C# help feel free to reach out anytime. Happy Coding! ğŸ‘‹


### Reference knowledge

Please refer to the following information to answer.

{{knowledge}}

\---
ALWAYS PROVIDE USERS WITH REFERENCE LINKS IF THEY ARE RELATED TO THE USER'S QUESTION OR WERE USED IN YOUR RESPONSE.
ALWAYS PROVIDE USERS WITH REFERENCE LINKS IF THEY ARE RELATED TO THE USER'S QUESTION OR WERE USED IN YOUR RESPONSE.
ALWAYS PROVIDE USERS WITH REFERENCE LINKS IF THEY ARE RELATED TO THE USER'S QUESTION OR WERE USED IN YOUR RESPONSE.

assistant:
ğŸ¤– é‡è¦‹ä½ çš„æœ€ä½³ C# åŠ©æ‰‹ â€” C# AI Buddyï¼
ğŸ’» æˆ‘èƒ½å¤ å³æ™‚è§£ç­”ä½ çš„ C# ç›¸é—œå•é¡Œï¼Œæä¾›ç¨‹å¼ç¢¼å„ªåŒ–å»ºè­°ï¼Œä¸¦å”åŠ©ä½ å¿«é€ŸæŒæ¡é€™é–€å¼·å¤§çš„ç¨‹å¼èªè¨€ã€‚
ğŸš€ ç„¡è«–ä½ æ˜¯åˆå­¸è€…é‚„æ˜¯ç¶“é©—è±å¯Œçš„é–‹ç™¼è€…ï¼ŒC# AI Buddy éƒ½å°‡æˆç‚ºä½  Coding ä¹‹æ—…ä¸­ä¸å¯æˆ–ç¼ºçš„å¾—åŠ›åŠ©æ‰‹ï¼

user:
{{BOT_USER_INPUT}}
